<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>ModernDive</title>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
  <meta name="description" content="Combining statistical and computational thinking to make sense of data. Getting away from the traditional introductory statistics curriculum, more focused on reproducible research, data visualization, and modern data analysis techniques and tools including resampling and bootstrapping using R, RStudio, and R Markdown">
  <meta name="generator" content="bookdown 0.3 and GitBook 2.6.7">

  <meta property="og:title" content="ModernDive" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Combining statistical and computational thinking to make sense of data. Getting away from the traditional introductory statistics curriculum, more focused on reproducible research, data visualization, and modern data analysis techniques and tools including resampling and bootstrapping using R, RStudio, and R Markdown" />
  <meta name="github-repo" content="ismayc/moderndiver-book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="ModernDive" />
  
  <meta name="twitter:description" content="Combining statistical and computational thinking to make sense of data. Getting away from the traditional introductory statistics curriculum, more focused on reproducible research, data visualization, and modern data analysis techniques and tools including resampling and bootstrapping using R, RStudio, and R Markdown" />
  

<meta name="author" content="Chester Ismay and Albert Y. Kim">


<meta name="date" content="2017-01-06">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="6-simulating-randomness-via-mosaic.html">
<link rel="next" href="8-ci.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-0.8/htmlwidgets.js"></script>
<link href="libs/dygraphs-1.1.1/dygraph.css" rel="stylesheet" />
<script src="libs/dygraphs-1.1.1/dygraph-combined.js"></script>
<script src="libs/moment-2.8.4/moment.js"></script>
<script src="libs/moment-timezone-0.2.5/moment-timezone-with-data.js"></script>
<script src="libs/moment-fquarter-1.0.0/moment-fquarter.min.js"></script>
<script src="libs/dygraphs-binding-1.1.1.4/dygraphs.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>


  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Prerequisites</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#colophon"><i class="fa fa-check"></i>Colophon</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="2-intro.html"><a href="2-intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a><ul>
<li class="chapter" data-level="2.1" data-path="2-intro.html"><a href="2-intro.html#preamble"><i class="fa fa-check"></i><b>2.1</b> Preamble</a></li>
<li class="chapter" data-level="2.2" data-path="2-intro.html"><a href="2-intro.html#two-driving-data-sources"><i class="fa fa-check"></i><b>2.2</b> Two driving data sources</a></li>
<li class="chapter" data-level="2.3" data-path="2-intro.html"><a href="2-intro.html#datascience-pipeline"><i class="fa fa-check"></i><b>2.3</b> Data/science pipeline</a></li>
<li class="chapter" data-level="2.4" data-path="2-intro.html"><a href="2-intro.html#reproducibility"><i class="fa fa-check"></i><b>2.4</b> Reproducibility</a></li>
<li class="chapter" data-level="2.5" data-path="2-intro.html"><a href="2-intro.html#who-is-this-book-for"><i class="fa fa-check"></i><b>2.5</b> Who is this book for?</a></li>
</ul></li>
<li class="part"><span><b>I Data Exploration</b></span></li>
<li class="chapter" data-level="3" data-path="3-tidy.html"><a href="3-tidy.html"><i class="fa fa-check"></i><b>3</b> Tidy Data</a><ul>
<li class="chapter" data-level="3.1" data-path="3-tidy.html"><a href="3-tidy.html#what-is-tidy-data"><i class="fa fa-check"></i><b>3.1</b> What is tidy data?</a></li>
<li class="chapter" data-level="3.2" data-path="3-tidy.html"><a href="3-tidy.html#the-nycflights13-datasets"><i class="fa fa-check"></i><b>3.2</b> The <code>nycflights13</code> datasets</a></li>
<li class="chapter" data-level="3.3" data-path="3-tidy.html"><a href="3-tidy.html#how-is-flights-tidy"><i class="fa fa-check"></i><b>3.3</b> How is <code>flights</code> tidy?</a></li>
<li class="chapter" data-level="3.4" data-path="3-tidy.html"><a href="3-tidy.html#normal-forms-of-data"><i class="fa fa-check"></i><b>3.4</b> Normal forms of data</a></li>
<li class="chapter" data-level="3.5" data-path="3-tidy.html"><a href="3-tidy.html#whats-to-come"><i class="fa fa-check"></i><b>3.5</b> What’s to come?</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="4-data-visualization-via-ggplot2.html"><a href="4-data-visualization-via-ggplot2.html"><i class="fa fa-check"></i><b>4</b> Data Visualization via <code id="viz">ggplot2</code></a><ul>
<li class="chapter" data-level="4.1" data-path="4-data-visualization-via-ggplot2.html"><a href="4-data-visualization-via-ggplot2.html#five-named-graphs---the-5ng"><i class="fa fa-check"></i><b>4.1</b> Five Named Graphs - The 5NG</a></li>
<li class="chapter" data-level="4.2" data-path="4-data-visualization-via-ggplot2.html"><a href="4-data-visualization-via-ggplot2.html#histograms"><i class="fa fa-check"></i><b>4.2</b> Histograms</a><ul>
<li class="chapter" data-level="4.2.1" data-path="4-data-visualization-via-ggplot2.html"><a href="4-data-visualization-via-ggplot2.html#contsum"><i class="fa fa-check"></i><b>4.2.1</b> Continuous data summaries</a></li>
<li class="chapter" data-level="4.2.2" data-path="4-data-visualization-via-ggplot2.html"><a href="4-data-visualization-via-ggplot2.html#summary"><i class="fa fa-check"></i><b>4.2.2</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="4-data-visualization-via-ggplot2.html"><a href="4-data-visualization-via-ggplot2.html#boxplots"><i class="fa fa-check"></i><b>4.3</b> Boxplots</a><ul>
<li class="chapter" data-level="4.3.1" data-path="4-data-visualization-via-ggplot2.html"><a href="4-data-visualization-via-ggplot2.html#faceting"><i class="fa fa-check"></i><b>4.3.1</b> Faceting</a></li>
<li class="chapter" data-level="4.3.2" data-path="4-data-visualization-via-ggplot2.html"><a href="4-data-visualization-via-ggplot2.html#summary-1"><i class="fa fa-check"></i><b>4.3.2</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="4-data-visualization-via-ggplot2.html"><a href="4-data-visualization-via-ggplot2.html#barplots"><i class="fa fa-check"></i><b>4.4</b> Barplots</a><ul>
<li class="chapter" data-level="4.4.1" data-path="4-data-visualization-via-ggplot2.html"><a href="4-data-visualization-via-ggplot2.html#must-avoid-pie-charts"><i class="fa fa-check"></i><b>4.4.1</b> Must avoid pie charts!</a></li>
<li class="chapter" data-level="4.4.2" data-path="4-data-visualization-via-ggplot2.html"><a href="4-data-visualization-via-ggplot2.html#using-barplots-to-compare-two-variables"><i class="fa fa-check"></i><b>4.4.2</b> Using barplots to compare two variables</a></li>
<li class="chapter" data-level="4.4.3" data-path="4-data-visualization-via-ggplot2.html"><a href="4-data-visualization-via-ggplot2.html#summary-2"><i class="fa fa-check"></i><b>4.4.3</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="4-data-visualization-via-ggplot2.html"><a href="4-data-visualization-via-ggplot2.html#scatter-plots"><i class="fa fa-check"></i><b>4.5</b> Scatter-plots</a><ul>
<li class="chapter" data-level="4.5.1" data-path="4-data-visualization-via-ggplot2.html"><a href="4-data-visualization-via-ggplot2.html#jittering"><i class="fa fa-check"></i><b>4.5.1</b> Jittering</a></li>
<li class="chapter" data-level="4.5.2" data-path="4-data-visualization-via-ggplot2.html"><a href="4-data-visualization-via-ggplot2.html#setting-transparency"><i class="fa fa-check"></i><b>4.5.2</b> Setting transparency</a></li>
<li class="chapter" data-level="4.5.3" data-path="4-data-visualization-via-ggplot2.html"><a href="4-data-visualization-via-ggplot2.html#summary-3"><i class="fa fa-check"></i><b>4.5.3</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="4-data-visualization-via-ggplot2.html"><a href="4-data-visualization-via-ggplot2.html#line-graphs"><i class="fa fa-check"></i><b>4.6</b> Line-graphs</a><ul>
<li class="chapter" data-level="4.6.1" data-path="4-data-visualization-via-ggplot2.html"><a href="4-data-visualization-via-ggplot2.html#summary-4"><i class="fa fa-check"></i><b>4.6.1</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="4-data-visualization-via-ggplot2.html"><a href="4-data-visualization-via-ggplot2.html#brief-review-of-the-grammar-of-graphics"><i class="fa fa-check"></i><b>4.7</b> Brief Review of The Grammar of Graphics</a></li>
<li class="chapter" data-level="4.8" data-path="4-data-visualization-via-ggplot2.html"><a href="4-data-visualization-via-ggplot2.html#script-of-r-code"><i class="fa fa-check"></i><b>4.8</b> Script of R code</a></li>
<li class="chapter" data-level="4.9" data-path="4-data-visualization-via-ggplot2.html"><a href="4-data-visualization-via-ggplot2.html#whats-to-come-1"><i class="fa fa-check"></i><b>4.9</b> What’s to come?</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="5-data-manipulation-via-dplyr.html"><a href="5-data-manipulation-via-dplyr.html"><i class="fa fa-check"></i><b>5</b> Data Manipulation via <code id="manip">dplyr</code></a><ul>
<li class="chapter" data-level="5.1" data-path="5-data-manipulation-via-dplyr.html"><a href="5-data-manipulation-via-dplyr.html#five-main-verbs---the-fmv"><i class="fa fa-check"></i><b>5.1</b> Five Main Verbs - The FMV</a><ul>
<li class="chapter" data-level="5.1.1" data-path="5-data-manipulation-via-dplyr.html"><a href="5-data-manipulation-via-dplyr.html#select-variables-using-select"><i class="fa fa-check"></i><b>5.1.1</b> Select variables using <code id="select">select</code></a></li>
<li class="chapter" data-level="5.1.2" data-path="5-data-manipulation-via-dplyr.html"><a href="5-data-manipulation-via-dplyr.html#filter-observations-using-filter"><i class="fa fa-check"></i><b>5.1.2</b> Filter observations using <code id="filter">filter</code></a></li>
<li class="chapter" data-level="5.1.3" data-path="5-data-manipulation-via-dplyr.html"><a href="5-data-manipulation-via-dplyr.html#summarize-variables-using-summarize"><i class="fa fa-check"></i><b>5.1.3</b> Summarize variables using <code>summarize</code></a></li>
<li class="chapter" data-level="5.1.4" data-path="5-data-manipulation-via-dplyr.html"><a href="5-data-manipulation-via-dplyr.html#create-new-variableschange-old-variables-using-mutate"><i class="fa fa-check"></i><b>5.1.4</b> Create new variables/change old variables using <code>mutate</code></a></li>
<li class="chapter" data-level="5.1.5" data-path="5-data-manipulation-via-dplyr.html"><a href="5-data-manipulation-via-dplyr.html#reorder-the-data-frame-using-arrange"><i class="fa fa-check"></i><b>5.1.5</b> Reorder the data frame using <code id="arrange">arrange</code></a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="5-data-manipulation-via-dplyr.html"><a href="5-data-manipulation-via-dplyr.html#the-pipe"><i class="fa fa-check"></i><b>5.2</b> The pipe <code>%&gt;%</code></a></li>
<li class="chapter" data-level="5.3" data-path="5-data-manipulation-via-dplyr.html"><a href="5-data-manipulation-via-dplyr.html#joiningmerging-data-frames"><i class="fa fa-check"></i><b>5.3</b> Joining/merging data frames</a></li>
<li class="chapter" data-level="5.4" data-path="5-data-manipulation-via-dplyr.html"><a href="5-data-manipulation-via-dplyr.html#script-of-r-code-1"><i class="fa fa-check"></i><b>5.4</b> Script of R code</a></li>
<li class="chapter" data-level="5.5" data-path="5-data-manipulation-via-dplyr.html"><a href="5-data-manipulation-via-dplyr.html#whats-to-come-2"><i class="fa fa-check"></i><b>5.5</b> What’s to come?</a></li>
</ul></li>
<li class="part"><span><b>II Inference</b></span></li>
<li class="chapter" data-level="6" data-path="6-simulating-randomness-via-mosaic.html"><a href="6-simulating-randomness-via-mosaic.html"><i class="fa fa-check"></i><b>6</b> Simulating Randomness via <code id="infer-basics">mosaic</code></a><ul>
<li class="chapter" data-level="6.1" data-path="6-simulating-randomness-via-mosaic.html"><a href="6-simulating-randomness-via-mosaic.html#needed-packages"><i class="fa fa-check"></i><b>6.1</b> Needed packages</a></li>
<li class="chapter" data-level="6.2" data-path="6-simulating-randomness-via-mosaic.html"><a href="6-simulating-randomness-via-mosaic.html#random-sampling"><i class="fa fa-check"></i><b>6.2</b> Random sampling</a><ul>
<li class="chapter" data-level="6.2.1" data-path="6-simulating-randomness-via-mosaic.html"><a href="6-simulating-randomness-via-mosaic.html#tasting-soup"><i class="fa fa-check"></i><b>6.2.1</b> Tasting soup</a></li>
<li class="chapter" data-level="6.2.2" data-path="6-simulating-randomness-via-mosaic.html"><a href="6-simulating-randomness-via-mosaic.html#common-terms"><i class="fa fa-check"></i><b>6.2.2</b> Common terms</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="6-simulating-randomness-via-mosaic.html"><a href="6-simulating-randomness-via-mosaic.html#visualizing-sampling"><i class="fa fa-check"></i><b>6.3</b> Visualizing Sampling</a><ul>
<li class="chapter" data-level="6.3.1" data-path="6-simulating-randomness-via-mosaic.html"><a href="6-simulating-randomness-via-mosaic.html#sampling-distribution"><i class="fa fa-check"></i><b>6.3.1</b> Sampling distribution</a></li>
<li class="chapter" data-level="6.3.2" data-path="6-simulating-randomness-via-mosaic.html"><a href="6-simulating-randomness-via-mosaic.html#repeated-sampling-via-do"><i class="fa fa-check"></i><b>6.3.2</b> Repeated sampling via <code>do</code></a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="6-simulating-randomness-via-mosaic.html"><a href="6-simulating-randomness-via-mosaic.html#simulation"><i class="fa fa-check"></i><b>6.4</b> Simulation</a></li>
<li class="chapter" data-level="6.5" data-path="6-simulating-randomness-via-mosaic.html"><a href="6-simulating-randomness-via-mosaic.html#review-of-mosaic-simulation-functions"><i class="fa fa-check"></i><b>6.5</b> Review of <code>mosaic</code> simulation functions</a></li>
<li class="chapter" data-level="6.6" data-path="6-simulating-randomness-via-mosaic.html"><a href="6-simulating-randomness-via-mosaic.html#script-of-r-code-2"><i class="fa fa-check"></i><b>6.6</b> Script of R code</a></li>
<li class="chapter" data-level="6.7" data-path="6-simulating-randomness-via-mosaic.html"><a href="6-simulating-randomness-via-mosaic.html#whats-to-come-3"><i class="fa fa-check"></i><b>6.7</b> What’s to come?</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="7-hypo.html"><a href="7-hypo.html"><i class="fa fa-check"></i><b>7</b> Hypothesis Testing</a><ul>
<li class="chapter" data-level="7.1" data-path="7-hypo.html"><a href="7-hypo.html#needed-packages-1"><i class="fa fa-check"></i><b>7.1</b> Needed packages</a></li>
<li class="chapter" data-level="7.2" data-path="7-hypo.html"><a href="7-hypo.html#basics-of-hypothesis-testing"><i class="fa fa-check"></i><b>7.2</b> Basics of Hypothesis Testing</a></li>
<li class="chapter" data-level="7.3" data-path="7-hypo.html"><a href="7-hypo.html#trial"><i class="fa fa-check"></i><b>7.3</b> Criminal trial analogy</a><ul>
<li class="chapter" data-level="7.3.1" data-path="7-hypo.html"><a href="7-hypo.html#two-possible-conclusions"><i class="fa fa-check"></i><b>7.3.1</b> Two possible conclusions</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="7-hypo.html"><a href="7-hypo.html#types-of-errors-in-hypothesis-testing"><i class="fa fa-check"></i><b>7.4</b> Types of Errors in Hypothesis Testing</a><ul>
<li class="chapter" data-level="7.4.1" data-path="7-hypo.html"><a href="7-hypo.html#logic-of-hypothesis-testing"><i class="fa fa-check"></i><b>7.4.1</b> Logic of Hypothesis Testing</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="7-hypo.html"><a href="7-hypo.html#statistical-significance"><i class="fa fa-check"></i><b>7.5</b> Statistical Significance</a></li>
<li class="chapter" data-level="7.6" data-path="7-hypo.html"><a href="7-hypo.html#revisiting-the-lady-tasting-tea-example"><i class="fa fa-check"></i><b>7.6</b> Revisiting the Lady Tasting Tea example</a><ul>
<li class="chapter" data-level="7.6.1" data-path="7-hypo.html"><a href="7-hypo.html#data"><i class="fa fa-check"></i><b>7.6.1</b> Data</a></li>
<li class="chapter" data-level="7.6.2" data-path="7-hypo.html"><a href="7-hypo.html#test-statistic-delta"><i class="fa fa-check"></i><b>7.6.2</b> Test Statistic <span class="math inline">\(\delta\)</span></a></li>
<li class="chapter" data-level="7.6.3" data-path="7-hypo.html"><a href="7-hypo.html#observed-effect-delta"><i class="fa fa-check"></i><b>7.6.3</b> Observed effect <span class="math inline">\(\delta^*\)</span></a></li>
<li class="chapter" data-level="7.6.4" data-path="7-hypo.html"><a href="7-hypo.html#model-of-h_0"><i class="fa fa-check"></i><b>7.6.4</b> Model of <span class="math inline">\(H_0\)</span></a></li>
<li class="chapter" data-level="7.6.5" data-path="7-hypo.html"><a href="7-hypo.html#simulated-data"><i class="fa fa-check"></i><b>7.6.5</b> Simulated Data</a></li>
<li class="chapter" data-level="7.6.6" data-path="7-hypo.html"><a href="7-hypo.html#distribution-of-delta-under-h_0"><i class="fa fa-check"></i><b>7.6.6</b> Distribution of <span class="math inline">\(\delta\)</span> under <span class="math inline">\(H_0\)</span></a></li>
<li class="chapter" data-level="7.6.7" data-path="7-hypo.html"><a href="7-hypo.html#the-p-value"><i class="fa fa-check"></i><b>7.6.7</b> The p-value</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="7-hypo.html"><a href="7-hypo.html#when-inference-is-not-needed"><i class="fa fa-check"></i><b>7.7</b> When Inference Is Not Needed</a></li>
<li class="chapter" data-level="7.8" data-path="7-hypo.html"><a href="7-hypo.html#script-of-r-code-3"><i class="fa fa-check"></i><b>7.8</b> Script of R code</a></li>
<li class="chapter" data-level="7.9" data-path="7-hypo.html"><a href="7-hypo.html#whats-to-come-4"><i class="fa fa-check"></i><b>7.9</b> What’s to come?</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="8-ci.html"><a href="8-ci.html"><i class="fa fa-check"></i><b>8</b> Confidence Intervals</a></li>
<li class="chapter" data-level="9" data-path="9-regression-via-broom.html"><a href="9-regression-via-broom.html"><i class="fa fa-check"></i><b>9</b> Regression via <code id="regress">broom</code></a><ul>
<li class="chapter" data-level="9.1" data-path="9-regression-via-broom.html"><a href="9-regression-via-broom.html#whats-to-come-5"><i class="fa fa-check"></i><b>9.1</b> What’s to come?</a></li>
</ul></li>
<li class="part"><span><b>III Conclusion</b></span></li>
<li class="chapter" data-level="10" data-path="10-effective-data-storytelling.html"><a href="10-effective-data-storytelling.html"><i class="fa fa-check"></i><b>10</b> Effective Data Storytelling</a><ul>
<li class="chapter" data-level="10.1" data-path="10-effective-data-storytelling.html"><a href="10-effective-data-storytelling.html#conclusion"><i class="fa fa-check"></i><b>10.1</b> Concluding Remarks</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="A-appendixA.html"><a href="A-appendixA.html"><i class="fa fa-check"></i><b>A</b> Statistical Background</a><ul>
<li class="chapter" data-level="A.1" data-path="A-appendixA.html"><a href="A-appendixA.html#basic-statistical-terms"><i class="fa fa-check"></i><b>A.1</b> Basic statistical terms</a><ul>
<li class="chapter" data-level="A.1.1" data-path="A-appendixA.html"><a href="A-appendixA.html#mean"><i class="fa fa-check"></i><b>A.1.1</b> Mean</a></li>
<li class="chapter" data-level="A.1.2" data-path="A-appendixA.html"><a href="A-appendixA.html#median"><i class="fa fa-check"></i><b>A.1.2</b> Median</a></li>
<li class="chapter" data-level="A.1.3" data-path="A-appendixA.html"><a href="A-appendixA.html#standard-deviation"><i class="fa fa-check"></i><b>A.1.3</b> Standard deviation</a></li>
<li class="chapter" data-level="A.1.4" data-path="A-appendixA.html"><a href="A-appendixA.html#five-number-summary"><i class="fa fa-check"></i><b>A.1.4</b> Five-number summary</a></li>
<li class="chapter" data-level="A.1.5" data-path="A-appendixA.html"><a href="A-appendixA.html#distribution"><i class="fa fa-check"></i><b>A.1.5</b> Distribution</a></li>
<li class="chapter" data-level="A.1.6" data-path="A-appendixA.html"><a href="A-appendixA.html#outliers"><i class="fa fa-check"></i><b>A.1.6</b> Outliers</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="B" data-path="B-appendixB.html"><a href="B-appendixB.html"><i class="fa fa-check"></i><b>B</b> Inference Examples</a><ul>
<li class="chapter" data-level="B.1" data-path="B-appendixB.html"><a href="B-appendixB.html#randomization"><i class="fa fa-check"></i><b>B.1</b> Randomization</a><ul>
<li class="chapter" data-level="B.1.1" data-path="B-appendixB.html"><a href="B-appendixB.html#comparing-action-and-romance-movies"><i class="fa fa-check"></i><b>B.1.1</b> Comparing Action and Romance Movies</a></li>
<li class="chapter" data-level="B.1.2" data-path="B-appendixB.html"><a href="B-appendixB.html#sampling-rightarrow-randomization"><i class="fa fa-check"></i><b>B.1.2</b> Sampling <span class="math inline">\(\rightarrow\)</span> Randomization</a></li>
<li class="chapter" data-level="B.1.3" data-path="B-appendixB.html"><a href="B-appendixB.html#summary-5"><i class="fa fa-check"></i><b>B.1.3</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="B.2" data-path="B-appendixB.html"><a href="B-appendixB.html#bootstrapping"><i class="fa fa-check"></i><b>B.2</b> Bootstrapping</a><ul>
<li class="chapter" data-level="B.2.1" data-path="B-appendixB.html"><a href="B-appendixB.html#review-of-bootstrapping"><i class="fa fa-check"></i><b>B.2.1</b> Review of Bootstrapping</a></li>
</ul></li>
<li class="chapter" data-level="B.3" data-path="B-appendixB.html"><a href="B-appendixB.html#relation-to-hypothesis-testing"><i class="fa fa-check"></i><b>B.3</b> Relation to hypothesis testing</a></li>
<li class="chapter" data-level="B.4" data-path="B-appendixB.html"><a href="B-appendixB.html#effect-size"><i class="fa fa-check"></i><b>B.4</b> Effect size</a></li>
<li class="chapter" data-level="B.5" data-path="B-appendixB.html"><a href="B-appendixB.html#script-of-r-code-4"><i class="fa fa-check"></i><b>B.5</b> Script of R code</a></li>
</ul></li>
<li class="chapter" data-level="C" data-path="C-appendixC.html"><a href="C-appendixC.html"><i class="fa fa-check"></i><b>C</b> Reach for the Starts</a><ul>
<li class="chapter" data-level="C.1" data-path="C-appendixC.html"><a href="C-appendixC.html#sorted-barplots"><i class="fa fa-check"></i><b>C.1</b> Sorted barplots</a></li>
<li class="chapter" data-level="C.2" data-path="C-appendixC.html"><a href="C-appendixC.html#interactive-graphics"><i class="fa fa-check"></i><b>C.2</b> Interactive graphics</a><ul>
<li class="chapter" data-level="C.2.1" data-path="C-appendixC.html"><a href="C-appendixC.html#interactive-line-graphs"><i class="fa fa-check"></i><b>C.2.1</b> Interactive line-graphs</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">ModernDive</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="hypo" class="section level1">
<h1><span class="header-section-number">7</span> Hypothesis Testing</h1>
<!--
+ Idea of histogram of sample being a visual approximation to population distribution.
    + Shiny
+ Standard errors and sampling distribution via randomization
    + Developing traditional inference from randomization
    + two-sample permutation test -> null distribution  
    + Showing what happens when assumptions/conditions aren’t met
    + Then show normal/t-test and show how it fits on top of sampling distribution
    + Shiny Google Forms
-->
<p>We saw some of the main concepts of hypothesis testing introduced in Chapter <a href="6-simulating-randomness-via-mosaic.html#infer-basics"><strong>??</strong></a>. We will expand further on these ideas here and also provide a framework for understanding hypothesis tests in general. Instead of presenting you with lots of different formulas and scenarios, we hope to build a way to think about all hypothesis tests. You can then adapt to different scenarios as needed down the road when you encounter different statistical situations.</p>
<p>The same can be said for confidence intervals. There is one general framework that applies to all confidence intervals and we will elaborate on this further in Chapter <a href="8-ci.html#ci">8</a>. The specifics may change slightly for each variation, but the important idea is to understand the general framework so that you can apply it to more specific problems. We believe that this approach is much better in the long-term than teaching you specific tests and confidence intervals rigorously. You can find full worked out examples for five common hypothesis tests and their corresponding confidence intervals in Appendix <a href="B-appendixB.html#appendixB">B</a>. We recommend that you carefully review these examples as they also cover how the general frameworks apply to traditional normal-based methodologies like the <span class="math inline">\(t\)</span>-test and normal-theory confidence intervals. You’ll see there that these methods are just approximations for the general frameworks, but require conditions to be met for their results to be valid. The general frameworks using randomization, simulation, and bootstrapping do not hold the same sorts of restrictions and further advance computational thinking, which is one big reason for their emphasis here.</p>
<div id="needed-packages-1" class="section level2">
<h2><span class="header-section-number">7.1</span> Needed packages</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr)
<span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(okcupiddata)
<span class="kw">library</span>(mosaic)
<span class="kw">library</span>(knitr)
<span class="kw">library</span>(nycflights13)</code></pre></div>
</div>
<div id="basics-of-hypothesis-testing" class="section level2">
<h2><span class="header-section-number">7.2</span> Basics of Hypothesis Testing</h2>
<p>In a hypothesis test, we will use data from a sample to help us decide between two competing <em>hypotheses</em> about a population. We make these hypotheses more concrete by specifying them in terms of at least one <em>population parameter</em> of interest. We refer to the competing claims about the population as the <strong>null hypothesis</strong>, denoted by <span class="math inline">\(H_0\)</span>, and the <strong>alternative (or research) hypothesis</strong>, denoted by <span class="math inline">\(H_a\)</span>. The roles of these two hypotheses are NOT interchangeable.</p>
<ul>
<li>The claim for which we seek significant evidence is assigned to the alternative hypothesis. The alternative is usually what the experimenter or researcher wants to establish or find evidence for.</li>
<li>Usually, the null hypothesis is a claim that there really is “no effect” or “no difference.” In many cases, the null hypothesis represents the status quo or that nothing interesting is happening.<br />
</li>
<li>We assess the strength of evidence by assuming the null hypothesis is true and determining how unlikely it would be to see sample results/statistics as extreme (or more extreme) as those in the original sample.</li>
</ul>
<p>Hypothesis testing brings about many weird and incorrect notions in the scientific community and society at large. One reason for this is that statistics has traditionally been thought of as this magic box of algorithms and procedures to get to results and this has been readily apparent if you do a Google search of “flowchart statistics hypothesis tests”. There are so many different complex ways to determine which test is appropriate.</p>
<p>You’ll see that we don’t need to rely on these complicated series of assumptions and procedures to conduct a hypothesis test any longer. These methods were introduced in a time when computers weren’t powerful. Your cellphone (in 2016) has more power than the computers that sent NASA astronauts to the moon after all. We’ll see that ALL hypothesis tests can be broken down into the following framework given by Allen Downey <a href="http://allendowney.blogspot.com/2016/06/there-is-still-only-one-test.html">here</a>:</p>
<div class="figure" style="text-align: center"><span id="fig:htdowney"></span>
<img src="images/ht.png" alt="Hypothesis Testing Framework" width="\textwidth" />
<p class="caption">
Figure 7.1: Hypothesis Testing Framework
</p>
</div>
<p>Before we hop into this framework, we will provide another way to think about hypothesis testing that may be useful.</p>
</div>
<div id="trial" class="section level2">
<h2><span class="header-section-number">7.3</span> Criminal trial analogy</h2>
<p>We can think of hypothesis testing in the same context as a criminal trial in the United States. A criminal trial in the United States is a familiar situation in which a choice between two contradictory claims must be made. 1. The accuser of the crime must be judged either guilty or not guilty.</p>
<ol start="2" style="list-style-type: decimal">
<li><p>Under the U.S. system of justice, the individual on trial is initially presumed not guilty.</p></li>
<li><p>Only STRONG EVIDENCE to the contrary causes the not guilty claim to be rejected in favor of a guilty verdict.</p></li>
<li><p>The phrase “beyond a reasonable doubt” is often used to set the cutoff value for when enough evidence has been given to convict.</p></li>
</ol>
<p>Theoretically, we should never say “The person is innocent.” but instead “There is not sufficient evidence to show that the person is guilty.”</p>
<p>Now let’s compare that to how we look at a hypothesis test.</p>
<ol style="list-style-type: decimal">
<li><p>The decision about the population parameter(s) must be judged to follow one of two hypotheses.</p></li>
<li><p>We initially assume that <span class="math inline">\(H_0\)</span> is true.</p></li>
<li><p>The null hypothesis <span class="math inline">\(H_0\)</span> will be rejected (in favor of <span class="math inline">\(H_a\)</span>) only if the sample evidence strongly suggests that <span class="math inline">\(H_0\)</span> is false. If the sample does not provide such evidence, <span class="math inline">\(H_0\)</span> will not be rejected.</p></li>
<li><p>The analogy to “beyond a reasonable doubt” in hypothesis testing is what is known as the <strong>significance level</strong>. This will be set before conducting the hypothesis test and is denoted as <span class="math inline">\(\alpha\)</span>. Common values for <span class="math inline">\(\alpha\)</span> are 0.1, 0.01, and 0.05.</p></li>
</ol>
<div id="two-possible-conclusions" class="section level3">
<h3><span class="header-section-number">7.3.1</span> Two possible conclusions</h3>
<p>Therefore, we have two possible conclusions with hypothesis testing:</p>
<ul>
<li>Reject <span class="math inline">\(H_0\)</span><br />
</li>
<li>Fail to reject <span class="math inline">\(H_0\)</span></li>
</ul>
<p>Gut instinct says that “Fail to reject <span class="math inline">\(H_0\)</span>” should say “Accept <span class="math inline">\(H_0\)</span>” but this technically is not correct. Accepting <span class="math inline">\(H_0\)</span> is the same as saying that a person is innocent. We cannot show that a person is innocent; we can only say that there was not enough substantial evidence to find the person guilty.</p>
<p>When you run a hypothesis test, you are the jury of the trial. You decide whether there is enough evidence to convince yourself that <span class="math inline">\(H_a\)</span> is true (“the person is guilty”) or that there was not enough evidence to convince yourself <span class="math inline">\(H_a\)</span> is true (“the person is not guilty”). You must convince yourself (using statistical arguments) which hypothesis is the correct one given the sample information.</p>
<p><strong>Important note:</strong> Therefore, DO NOT WRITE “Accept <span class="math inline">\(H_0\)</span>” any time you conduct a hypothesis test. Instead write “Fail to reject <span class="math inline">\(H_0\)</span>.”</p>
</div>
</div>
<div id="types-of-errors-in-hypothesis-testing" class="section level2">
<h2><span class="header-section-number">7.4</span> Types of Errors in Hypothesis Testing</h2>
<p>Unfortunately, just as a jury or a judge can make an incorrect decision in regards to a criminal trial by reaching the wrong verdict, there is some chance we will reach the wrong conclusion via a hypothesis test about a population parameter. As with criminal trials, this comes from the fact that we don’t have complete information, but rather a sample from which to try to infer about a population.</p>
<p>The possible erroneous conclusions in a criminal trial are</p>
<ul>
<li>an innocent person is convicted (found guilty) or</li>
<li>a guilty person is set free (found not guilty).</li>
</ul>
<p>The possible errors in a hypothesis test are - rejecting <span class="math inline">\(H_0\)</span> when in fact <span class="math inline">\(H_0\)</span> is true (Type I Error) - failing to reject <span class="math inline">\(H_0\)</span> when in fact <span class="math inline">\(H_0\)</span> is false (Type II Error)</p>
<p>The risk of error is the price researchers pay for basing an inference about a population on a sample. With any reasonable sample-based procedure, there is some chance that a Type I error will be made and some chance that a Type II error will occur.</p>
<p>To help understand the concepts of Type I error and Type II error, observe the following table:</p>
<p><img src="images/errors.png" width="\textwidth" style="display: block; margin: auto;" /></p>
<p>If we are using sample data to make inferences about a parameter, we run the risk of making a mistake. Obviously, we want to minimize our chance of error; we want a small probability of drawing an incorrect conclusion.</p>
<ul>
<li>The probability of a Type I Error occurring is denoted by <span class="math inline">\(\alpha\)</span> and is called the <strong>significance level</strong> of a hypothesis test</li>
<li>The probability of a Type II Error is denoted by <span class="math inline">\(\beta\)</span>.</li>
</ul>
<p>Formally, we can define <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> in regards to the table above, but for hypothesis tests instead of a criminal trial.</p>
<ul>
<li><span class="math inline">\(\alpha\)</span> corresponds to the probability of rejecting <span class="math inline">\(H_0\)</span> when, in fact, <span class="math inline">\(H_0\)</span> is true.</li>
<li><span class="math inline">\(\beta\)</span> corresponds to the probability of failing to reject <span class="math inline">\(H_0\)</span> when, in fact, <span class="math inline">\(H_0\)</span> is false.</li>
</ul>
<p>Ideally, we want <span class="math inline">\(\alpha = 0\)</span> and <span class="math inline">\(\beta = 0\)</span>, meaning that the chance of making an error does not exist. When we have to use incomplete information (sample data), it is not possible to have both <span class="math inline">\(\alpha = 0\)</span> and <span class="math inline">\(\beta = 0\)</span>. We will always have the possibility of at least one error existing when we use sample data.</p>
<p>Usually, what is done is that <span class="math inline">\(\alpha\)</span> is set before the hypothesis test is conducted and then the evidence is judged against that significance level. Common values for <span class="math inline">\(\alpha\)</span> are 0.05, 0.01, and 0.10. If <span class="math inline">\(\alpha = 0.05\)</span>, we are using a testing procedure that, used over and over with different samples, rejects a TRUE null hypothesis five percent of the time.</p>
<p>So if we can set <span class="math inline">\(\alpha\)</span> to be whatever we want, why choose 0.05 instead of 0.01 or even better 0.0000000000000001? Well, a small <span class="math inline">\(\alpha\)</span> means the test procedure requires the evidence against <span class="math inline">\(H_0\)</span> to be <strong>very strong</strong> before we can reject <span class="math inline">\(H_0\)</span>. This means we will almost never reject <span class="math inline">\(H_0\)</span> if <span class="math inline">\(\alpha\)</span> is very small. If we almost never reject <span class="math inline">\(H_0\)</span>, the probability of a Type II Error – failing to reject <span class="math inline">\(H_0\)</span> when we should – will <em>increase</em>! Thus, as <span class="math inline">\(\alpha\)</span> decreases, <span class="math inline">\(\beta\)</span> increases and as <span class="math inline">\(\alpha\)</span> increases, <span class="math inline">\(\beta\)</span> decreases. We, therefore, need to strike a balance in <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> and the common values of 0.05, 0.01, and 0.10 usually lead to a nice balance.</p>
<hr />
<div class="learncheck">
<p>
<strong><em>Learning check</em></strong>
</p>
</div>
<p><strong>(LC7.1)</strong> Reproduce the table above, but for a hypothesis test, instead of the one provided for a criminal trial.</p>
<hr />
<div id="logic-of-hypothesis-testing" class="section level3">
<h3><span class="header-section-number">7.4.1</span> Logic of Hypothesis Testing</h3>
<ul>
<li>Take a random sample (or samples) from a population (or two populations)</li>
<li>If the sample data are consistent with the null hypothesis, do not reject the null hypothesis.</li>
<li>If the sample data are inconsistent with the null hypothesis (in the direction of the alternative hypothesis), reject the null hypothesis and conclude that there is evidence the alternative hypothesis is true (based on the particular sample collected).</li>
</ul>
</div>
</div>
<div id="statistical-significance" class="section level2">
<h2><span class="header-section-number">7.5</span> Statistical Significance</h2>
<p>The idea that sample results are more extreme than we would reasonably expect to see by random chance if the null hypothesis were true is the fundamental idea behind statistical hypothesis tests. If data as extreme would be very unlikely if the null hypothesis were true, we say the data are <strong>statistically significant</strong>. Statistically significant data provide convincing evidence against the null hypothesis in favor of the alternative, and allow us to generalize our sample results to the claim about the population.</p>
<hr />
<p><strong>Definition: Statistical Significance</strong></p>
<p>When results as extreme as the observed sample statistic are unlikely to occur by random chance alone (assuming the null hypothesis is true), we say the sample results/statistics are <em>statistically significant</em>. If our sample is statistically significant, we have convincing evidence against <span class="math inline">\(H_0\)</span> and in favor of <span class="math inline">\(H_a\)</span>.</p>
<hr />
<div class="learncheck">
<p>
<strong><em>Learning check</em></strong>
</p>
</div>
<p><strong>(LC7.2)</strong> What is wrong about saying “The defendant is innocent.” based on the US system of criminal trials?</p>
<p><strong>(LC7.3)</strong> What is the purpose of hypothesis testing?</p>
<p><strong>(LC7.4)</strong> What are some flaws with hypothesis testing? How could we alleviate them?</p>
<hr />
</div>
<div id="revisiting-the-lady-tasting-tea-example" class="section level2">
<h2><span class="header-section-number">7.6</span> Revisiting the Lady Tasting Tea example</h2>
<p>Recall the “There is Only One Test” diagram from earlier:</p>
<div class="figure" style="text-align: center"><span id="fig:htdowney2"></span>
<img src="images/ht.png" alt="Hypothesis Testing Framework" width="\textwidth" />
<p class="caption">
Figure 7.2: Hypothesis Testing Framework
</p>
</div>
<p>We will now walk-through how each of the steps to the diagram apply to determining whether the lady tasting tea was actually better than chance at determining whether or not milk was added first. We will see that the process of creating a null distribution is a statistical way to quantifying surprise.</p>
<div id="data" class="section level3">
<h3><span class="header-section-number">7.6.1</span> Data</h3>
<p>Let’s assume as we did in Chapter <a href="6-simulating-randomness-via-mosaic.html#infer-basics"><strong>??</strong></a>, that the lady is correct in determining whether milk was added first in 9 out of 10 trials. Our data, therefore, may look something like</p>
<table>
<tbody>
<tr class="odd">
<td align="left">Correct</td>
</tr>
<tr class="even">
<td align="left">Correct</td>
</tr>
<tr class="odd">
<td align="left">Correct</td>
</tr>
<tr class="even">
<td align="left">Incorrect</td>
</tr>
<tr class="odd">
<td align="left">Correct</td>
</tr>
<tr class="even">
<td align="left">Correct</td>
</tr>
<tr class="odd">
<td align="left">Correct</td>
</tr>
<tr class="even">
<td align="left">Correct</td>
</tr>
<tr class="odd">
<td align="left">Correct</td>
</tr>
<tr class="even">
<td align="left">Correct</td>
</tr>
</tbody>
</table>
</div>
<div id="test-statistic-delta" class="section level3">
<h3><span class="header-section-number">7.6.2</span> Test Statistic <span class="math inline">\(\delta\)</span></h3>
<p>We are interested in the number of <code>Correct</code> out of our 10 trials. We can denote this number of successes using the symbol <span class="math inline">\(t\)</span>, where <span class="math inline">\(t\)</span> corresponds to total. This is our test statistic <span class="math inline">\(\delta\)</span> in this case.</p>
</div>
<div id="observed-effect-delta" class="section level3">
<h3><span class="header-section-number">7.6.3</span> Observed effect <span class="math inline">\(\delta^*\)</span></h3>
<p>The actual observed value of the test statistic from our observed sample is <span class="math inline">\(\hat{t}_{obs} = 9\)</span>. Thus, <span class="math inline">\(\delta^* = 9\)</span>.</p>
</div>
<div id="model-of-h_0" class="section level3">
<h3><span class="header-section-number">7.6.4</span> Model of <span class="math inline">\(H_0\)</span></h3>
<p>Our null hypothesis is that the lady is only as good as chance at guessing correctly. Hypotheses always correspond to parameters and are denoted with Greek letters. Thus, symbolically, we have <span class="math inline">\(H_0: \tau = 5\)</span>. Since we are assuming chance and we have 10 flips with 0.5 probability of success of each flip, we have <span class="math inline">\(\tau = 10 \times 0.5 = 5\)</span>.</p>
</div>
<div id="simulated-data" class="section level3">
<h3><span class="header-section-number">7.6.5</span> Simulated Data</h3>
<p>We now want to use this null hypothesis to simulate the test statistic assuming that the null hypothesis is true. Therefore, we want to figure out a way to simulate in 10 trials, getting either the choice Correct or Incorrect, assuming that the probability of success (getting it Correct) in any given trial is 0.5.</p>
<p><strong>Tactile simulation</strong></p>
<p>When you are presented with a hypothesis testing problem, frequently the most challenging portion is setting up how to simulate the data assuming the null hypothesis is true. To facilitate with this, setting up a tactile, hands on experiment can help.</p>
<p>In this case, flipping a fair coin is a great way to simulate this process. To simulate 10 trials, we could flip the fair coin and record Heads as Correct and Tails as Incorrect.</p>
<p>Some simulated data using this coin flipping procedure may look like the following. Note that this data frame is not tidy, but is a convenient way to look at the results of the simulation in this wide format. The numbers on the fair left correspond to the number of the trial.</p>
<table>
<thead>
<tr class="header">
<th></th>
<th align="left">sample1</th>
<th align="left">sample2</th>
<th align="left">sample3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td align="left">Correct</td>
<td align="left">Correct</td>
<td align="left">Correct</td>
</tr>
<tr class="even">
<td>2</td>
<td align="left">Correct</td>
<td align="left">Incorrect</td>
<td align="left">Incorrect</td>
</tr>
<tr class="odd">
<td>3</td>
<td align="left">Incorrect</td>
<td align="left">Incorrect</td>
<td align="left">Correct</td>
</tr>
<tr class="even">
<td>4</td>
<td align="left">Incorrect</td>
<td align="left">Incorrect</td>
<td align="left">Correct</td>
</tr>
<tr class="odd">
<td>5</td>
<td align="left">Correct</td>
<td align="left">Incorrect</td>
<td align="left">Incorrect</td>
</tr>
<tr class="even">
<td>6</td>
<td align="left">Correct</td>
<td align="left">Incorrect</td>
<td align="left">Correct</td>
</tr>
<tr class="odd">
<td>7</td>
<td align="left">Incorrect</td>
<td align="left">Incorrect</td>
<td align="left">Correct</td>
</tr>
<tr class="even">
<td>8</td>
<td align="left">Incorrect</td>
<td align="left">Correct</td>
<td align="left">Incorrect</td>
</tr>
<tr class="odd">
<td>9</td>
<td align="left">Incorrect</td>
<td align="left">Correct</td>
<td align="left">Incorrect</td>
</tr>
<tr class="even">
<td>10</td>
<td align="left">Incorrect</td>
<td align="left">Correct</td>
<td align="left">Incorrect</td>
</tr>
</tbody>
</table>
<p>We then use the formula for the <strong>Test Statistic</strong> to determine the simulated test statistic for each of these simulated samples. So in this case we have</p>
<p><span class="math inline">\(t_1 = 4\)</span>, <span class="math inline">\(t_2 = 4\)</span>, <span class="math inline">\(t_3 = 5\)</span></p>
</div>
<div id="distribution-of-delta-under-h_0" class="section level3">
<h3><span class="header-section-number">7.6.6</span> Distribution of <span class="math inline">\(\delta\)</span> under <span class="math inline">\(H_0\)</span></h3>
<p>We could continue this process say 10,000 times by flipping a coin in sets of 10 for 10,000 repetitions and counting and taking note of how many heads out of 10 we have for each set. It’s at this point that you realize that a computer can do this procedure much faster and more efficient than the tactile experiment with a coin.</p>
<p>Recall that we’ve already created the distribution of 10,000 such coin flips in Chapter <a href="6-simulating-randomness-via-mosaic.html#infer-basics"><strong>??</strong></a> and we’ve stored these values in the <code>heads</code> variable in the <code>simGuesses</code> data frame:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
simGuesses %&gt;%<span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">factor</span>(heads))) +
<span class="st">  </span><span class="kw">geom_bar</span>()</code></pre></div>
<p><img src="ismaykim_files/figure-html/unnamed-chunk-85-1.png" width="\textwidth" style="display: block; margin: auto;" /></p>
</div>
<div id="the-p-value" class="section level3">
<h3><span class="header-section-number">7.6.7</span> The p-value</h3>
<hr />
<p><strong>Definition: <span class="math inline">\(p\)</span>-value</strong>:</p>
<p>The <strong>p-value</strong> is the probability of observing a sample statistic as extreme or more extreme than what was observed, assuming that the null hypothesis of a by chance operation is true.</p>
<hr />
<p>This definition may be a little intimidating the first time you read it, but it’s important to come back to this “The Lady Tasting Tea” problem whenever you encounter <span class="math inline">\(p\)</span>-values as you begin to learn about the concept. Here the <span class="math inline">\(p\)</span>-value corresponds to how many times in our <strong>null distribution</strong> of <code>heads</code> 9 or more heads occurred.</p>
<p>We can use another neat feature of R to calculate the <span class="math inline">\(p\)</span>-value for this problem. Note that “more extreme” in this case corresponds to looking at values of 9 or greater since our alternative hypothesis invokes a right-tail test corresponding to a “greater than” hypothesis of <span class="math inline">\(H_a: \pi &gt; 0.5\)</span>. In other words, we are looking to see how likely it is for the lady to pick 9 or more correct instead of 9 or less correct. We’d like to go in the right direction.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pvalue_tea &lt;-<span class="st"> </span>simGuesses %&gt;%
<span class="st">  </span><span class="kw">filter</span>(heads &gt;=<span class="st"> </span><span class="dv">9</span>) %&gt;%
<span class="st">  </span><span class="kw">nrow</span>() /<span class="st"> </span><span class="kw">nrow</span>(simGuesses)</code></pre></div>
<p>Let’s walk through each step of this calculation:</p>
<ol style="list-style-type: decimal">
<li><p>First, <code>pvalue_tea</code> will be the name of our calculated <span class="math inline">\(p\)</span>-value and the assignment operator <code>&lt;-</code> directs us to this naming.</p></li>
<li><p>We are working with the <code>simGuesses</code> data frame here so that comes immediately before the pipe operator.</p></li>
<li><p>We would like to only focus on the rows in our <code>simGuesses</code> data frame that have <code>heads</code> values of 9 or 10. This represents simulated statistics “as extreme or more extreme” than what we observed (9 correct guesses out of 10). Let’s get a glimpse of what we have up to this point:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">simGuesses %&gt;%<span class="st"> </span><span class="kw">filter</span>(heads &gt;=<span class="st"> </span><span class="dv">9</span>)    </code></pre></div>
<pre><code>##      n heads tails prop
## 1   10     9     1  0.9
## 2   10    10     0  1.0
## 3   10     9     1  0.9
## 4   10     9     1  0.9
## 5   10    10     0  1.0
## 6   10     9     1  0.9
## 7   10     9     1  0.9
## 8   10     9     1  0.9
## 9   10     9     1  0.9
## 10  10     9     1  0.9
## 11  10     9     1  0.9
## 12  10     9     1  0.9
## 13  10     9     1  0.9
## 14  10     9     1  0.9
## 15  10     9     1  0.9
## 16  10     9     1  0.9
## 17  10     9     1  0.9
## 18  10     9     1  0.9
## 19  10     9     1  0.9
## 20  10     9     1  0.9
## 21  10     9     1  0.9
## 22  10     9     1  0.9
## 23  10    10     0  1.0
## 24  10    10     0  1.0
## 25  10    10     0  1.0
## 26  10     9     1  0.9
## 27  10     9     1  0.9
## 28  10     9     1  0.9
## 29  10     9     1  0.9
## 30  10     9     1  0.9
## 31  10     9     1  0.9
## 32  10     9     1  0.9
## 33  10    10     0  1.0
## 34  10     9     1  0.9
## 35  10     9     1  0.9
## 36  10    10     0  1.0
## 37  10     9     1  0.9
## 38  10     9     1  0.9
## 39  10     9     1  0.9
## 40  10     9     1  0.9
## 41  10     9     1  0.9
## 42  10     9     1  0.9
## 43  10     9     1  0.9
## 44  10     9     1  0.9
## 45  10     9     1  0.9
## 46  10     9     1  0.9
## 47  10     9     1  0.9
## 48  10     9     1  0.9
## 49  10     9     1  0.9
## 50  10     9     1  0.9
## 51  10     9     1  0.9
## 52  10     9     1  0.9
## 53  10     9     1  0.9
## 54  10     9     1  0.9
## 55  10     9     1  0.9
## 56  10    10     0  1.0
## 57  10    10     0  1.0
## 58  10     9     1  0.9
## 59  10     9     1  0.9
## 60  10     9     1  0.9
## 61  10     9     1  0.9
## 62  10     9     1  0.9
## 63  10     9     1  0.9
## 64  10     9     1  0.9
## 65  10     9     1  0.9
## 66  10    10     0  1.0
## 67  10     9     1  0.9
## 68  10     9     1  0.9
## 69  10     9     1  0.9
## 70  10     9     1  0.9
## 71  10     9     1  0.9
## 72  10     9     1  0.9
## 73  10     9     1  0.9
## 74  10     9     1  0.9
## 75  10     9     1  0.9
## 76  10     9     1  0.9
## 77  10     9     1  0.9
## 78  10     9     1  0.9
## 79  10    10     0  1.0
## 80  10     9     1  0.9
## 81  10     9     1  0.9
## 82  10    10     0  1.0
## 83  10     9     1  0.9
## 84  10     9     1  0.9
## 85  10     9     1  0.9
## 86  10    10     0  1.0
## 87  10    10     0  1.0
## 88  10     9     1  0.9
## 89  10     9     1  0.9
## 90  10     9     1  0.9
## 91  10     9     1  0.9
## 92  10     9     1  0.9
## 93  10     9     1  0.9
## 94  10     9     1  0.9
## 95  10     9     1  0.9
## 96  10     9     1  0.9
## 97  10     9     1  0.9
## 98  10     9     1  0.9
## 99  10     9     1  0.9
## 100 10     9     1  0.9
## 101 10     9     1  0.9
## 102 10     9     1  0.9
## 103 10     9     1  0.9
## 104 10     9     1  0.9
## 105 10     9     1  0.9</code></pre></li>
<li><p>Now that we have changed the focus to only those rows that have number of heads out of 10 flips corresponding to 9 or more, we count how many of those there are. The function <code>nrow</code> gives how many entries are in this filtered data frame and lastly we calculate the proportion that are at least as extreme as our observed value of 9 by dividing by the number of total simulations (10,000).</p></li>
</ol>
<p>We can see that the observed statistic of 9 correct guesses is not a likely outcome assuming the null hypothesis is true. Only around 1% of the outcomes in our 10,000 simulations fall at or above 9 successes. We have evidence supporting the conclusion that the person is actually better than just guessing at random at determining whether milk has been added first or not. To better visualize this we can also make use of pink shading on the histogram corresponding to the <span class="math inline">\(p\)</span>-value:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
simGuesses %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">factor</span>(heads), <span class="dt">fill =</span> (heads &gt;=<span class="st"> </span><span class="dv">9</span>))) +
<span class="st">  </span><span class="kw">geom_bar</span>() +
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;heads&quot;</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-88"></span>
<img src="ismaykim_files/figure-html/unnamed-chunk-88-1.png" alt="Barplot of heads with p-value highlighted" width="\textwidth" />
<p class="caption">
Figure 7.3: Barplot of heads with p-value highlighted
</p>
</div>
<p>This helps us better see just how few of the values of <code>heads</code> are at our observed value or more extreme.</p>
<p>We’ll see in Chapters <a href="7-hypo.html#hypo">7</a> and <a href="8-ci.html#ci">8</a> that this idea of a <span class="math inline">\(p\)</span>-value can be extended to the more traditional methods using normal and <span class="math inline">\(t\)</span> distributions in the traditional way that introductory statistics has been presented. These traditional methods were used because statisticians haven’t always been able to do 10,000 simulations on the computer within seconds. We’ll elaborate on this more in these later chapters.</p>
<hr />
<div class="learncheck">
<p>
<strong><em>Learning check</em></strong>
</p>
</div>
<p><strong>(LC7.5)</strong> What is meant by “pseudo-random number generation?”</p>
<p><strong>(LC7.6)</strong> How can simulation be used to help us address the question of whether or not an observed result is statistically significant?</p>
<p><strong>(LC7.7)</strong> In Chapter <a href="4-data-visualization-via-ggplot2.html#viz"><strong>??</strong></a>, we noted that barplots should be used when creating a plot of categorical variables. Why are we using barplots to make a plot of a numerical variable <code>heads</code> in this chapter?</p>
<hr />
</div>
</div>
<div id="when-inference-is-not-needed" class="section level2">
<h2><span class="header-section-number">7.7</span> When Inference Is Not Needed</h2>
<p>An important and time-saving skill is to <strong>ALWAYS</strong> do exploratory data analysis using <code>dplyr</code> and <code>ggplot2</code> before thinking about running a hypothesis test. Let’s look at such an example selecting a sample of flights traveling to Boston and to San Francisco from New York City in the <code>flights</code> data frame in the <code>nycflights13</code> package. (We will remove flights with missing data first using <code>na.omit</code> and then sample 100 flights going to each of the two airports.)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(nycflights13)
<span class="kw">data</span>(flights)
bos_sfo &lt;-<span class="st"> </span>flights %&gt;%<span class="st"> </span><span class="kw">na.omit</span>() %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(dest %in%<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;BOS&quot;</span>, <span class="st">&quot;SFO&quot;</span>)) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(dest) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">sample_n</span>(<span class="dv">100</span>)</code></pre></div>
<p>Suppose we were interested in seeing if the <code>air_time</code> to SFO in San Francisco was statistically greater than the <code>air_time</code> to BOS in Boston. As suggested, let’s begin with some exploratory data analysis to get a sense for how the two variables of <code>air_time</code> and <code>dest</code> relate for these two destination airports:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr)
bos_sfo %&gt;%<span class="st"> </span><span class="kw">group_by</span>(dest) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">summarize</span>(<span class="dt">mean_time =</span> <span class="kw">mean</span>(air_time),
            <span class="dt">sd_time =</span> <span class="kw">sd</span>(air_time))</code></pre></div>
<pre><code>## # A tibble: 2 × 3
##    dest mean_time   sd_time
##   &lt;chr&gt;     &lt;dbl&gt;     &lt;dbl&gt;
## 1   BOS     38.06  3.773432
## 2   SFO    346.84 16.193726</code></pre>
<p>Looking at these results, we can clearly see that SFO <code>air_time</code> is much larger than BOS <code>air_time</code>. The standard deviation is also extremely informative here.</p>
<hr />
<div class="learncheck">
<p>
<strong><em>Learning check</em></strong>
</p>
</div>
<p><strong>(LC7.8)</strong> Could we make the same type of immediate conclusion that SFO had a statistically greater <code>air_time</code> if, say, its corresponding standard deviation was 200 minutes? What about 100 minutes? Explain.</p>
<hr />
<p>To further understand just how different the <code>air_time</code> variable is for BOS and SFO, let’s look at a boxplot:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">ggplot</span>(<span class="dt">data =</span> bos_sfo, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> dest, <span class="dt">y =</span> air_time)) +
<span class="st">  </span><span class="kw">geom_boxplot</span>()</code></pre></div>
<p><img src="ismaykim_files/figure-html/unnamed-chunk-91-1.png" width="\textwidth" style="display: block; margin: auto;" /></p>
<p>Since there is no overlap at all, we can conclude that the <code>air_time</code> for San Francisco flights is statistically greater (at any level of significance) than the <code>air_time</code> for Boston flights. This is a clear example of not needing to do anything more than some simple descriptive statistics to get an appropriate inferential conclusion. This is one reason why you should <strong>ALWAYS</strong> investigate the sample data first using <code>dplyr</code> and <code>ggplot2</code> via exploratory data analysis.</p>
<p>As you get more and more practice with hypothesis testing, you’ll be better able to determine in many cases whether or not the results will be statistically significant. There are circumstances where it is difficult to tell, but you should always try to make a guess FIRST about significance after you have completed your data exploration and before you actually begin the inferential techniques.</p>
</div>
<div id="script-of-r-code-3" class="section level2">
<h2><span class="header-section-number">7.8</span> Script of R code</h2>
<p>An R script file of all R code used in this chapter is available <a href="http://ismayc.github.io/moderndiver-book/07-hypo.R">here</a>.</p>
</div>
<div id="whats-to-come-4" class="section level2">
<h2><span class="header-section-number">7.9</span> What’s to come?</h2>
<p>This chapter examined the basics of hypothesis testing with terminology and also an example of how to apply the “There is Only One Test” diagram to the Lady Tasting Tea example presented in Chapter <a href="6-simulating-randomness-via-mosaic.html#infer-basics"><strong>??</strong></a>. We’ll see in Chapter <a href="8-ci.html#ci">8</a> how we can provide a range of possible values for an unknown population parameter instead of just running a Yes/No decision from a hypothesis test.</p>
<p>We will see in Chapter <a href="9-regression-via-broom.html#regress"><strong>??</strong></a> many of the same ideas we have seen with hypothesis testing and confidence intervals in the last two chapters. Regression is frequently associated both correctly and incorrectly with statistics and data analysis, so you’ll need to make sure you understand when it is appropriate and when it is not.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="6-simulating-randomness-via-mosaic.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="8-ci.html" class="navigation navigation-next " aria-label="Next page""><i class="fa fa-angle-right"></i></a>

<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/ismayc/moderndiver-source/edit/master/07-hypo.Rmd",
"text": "Edit"
},
"download": ["ismaykim.pdf"],
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
