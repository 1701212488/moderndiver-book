<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>An Introduction to Statistical and Data Sciences via R</title>
  <meta name="description" content="An open-source and fully-reproducible electronic textbook bridging the gap between traditional introductory statistics and data science courses.">
  <meta name="generator" content="bookdown 0.5 and GitBook 2.6.7">

  <meta property="og:title" content="An Introduction to Statistical and Data Sciences via R" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="http://moderndive.com/" />
  <meta property="og:image" content="http://moderndive.com/images/logos/book_cover.png" />
  <meta property="og:description" content="An open-source and fully-reproducible electronic textbook bridging the gap between traditional introductory statistics and data science courses." />
  <meta name="github-repo" content="ismayc/moderndiver-book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="An Introduction to Statistical and Data Sciences via R" />
  
  <meta name="twitter:description" content="An open-source and fully-reproducible electronic textbook bridging the gap between traditional introductory statistics and data science courses." />
  <meta name="twitter:image" content="http://moderndive.com/images/logos/book_cover.png" />

<meta name="author" content="Chester Ismay and Albert Y. Kim">


<meta name="date" content="2017-11-09">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="5-wrangling.html">
<link rel="next" href="7-sampling.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-0.9/htmlwidgets.js"></script>
<link href="libs/dygraphs-1.1.1/dygraph.css" rel="stylesheet" />
<script src="libs/dygraphs-1.1.1/dygraph-combined.js"></script>
<script src="libs/moment-2.8.4/moment.js"></script>
<script src="libs/moment-timezone-0.2.5/moment-timezone-with-data.js"></script>
<script src="libs/moment-fquarter-1.0.0/moment-fquarter.min.js"></script>
<script src="libs/dygraphs-binding-1.1.1.4/dygraphs.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-89938436-1', 'auto');
  ga('send', 'pageview');

</script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#intro-for-students"><i class="fa fa-check"></i><b>1.1</b> Introduction for students</a><ul>
<li class="chapter" data-level="1.1.1" data-path="index.html"><a href="index.html#learning-goals"><i class="fa fa-check"></i><b>1.1.1</b> What you will learn from this book</a></li>
<li class="chapter" data-level="1.1.2" data-path="index.html"><a href="index.html#pipeline"><i class="fa fa-check"></i><b>1.1.2</b> Data/science pipeline</a></li>
<li class="chapter" data-level="1.1.3" data-path="index.html"><a href="index.html#reproducible"><i class="fa fa-check"></i><b>1.1.3</b> Reproducible research</a></li>
<li class="chapter" data-level="1.1.4" data-path="index.html"><a href="index.html#final-note-for-students"><i class="fa fa-check"></i><b>1.1.4</b> Final note for students</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#intro-instructors"><i class="fa fa-check"></i><b>1.2</b> Introduction for instructors</a><ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#who-is-this-book-for"><i class="fa fa-check"></i><b>1.2.1</b> Who is this book for?</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#connect-contribute"><i class="fa fa-check"></i><b>1.3</b> Connect and contribute</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#about-book"><i class="fa fa-check"></i><b>1.4</b> About this book</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="2-getting-started.html"><a href="2-getting-started.html"><i class="fa fa-check"></i><b>2</b> Getting Started</a><ul>
<li class="chapter" data-level="2.1" data-path="2-getting-started.html"><a href="2-getting-started.html#what-are-r-and-rstudio"><i class="fa fa-check"></i><b>2.1</b> What are R and RStudio?</a><ul>
<li class="chapter" data-level="2.1.1" data-path="2-getting-started.html"><a href="2-getting-started.html#installing-r-and-rstudio"><i class="fa fa-check"></i><b>2.1.1</b> Installing R and RStudio</a></li>
<li class="chapter" data-level="2.1.2" data-path="2-getting-started.html"><a href="2-getting-started.html#using-r-via-rstudio"><i class="fa fa-check"></i><b>2.1.2</b> Using R via RStudio</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="2-getting-started.html"><a href="2-getting-started.html#code"><i class="fa fa-check"></i><b>2.2</b> How do I code in R?</a><ul>
<li class="chapter" data-level="2.2.1" data-path="2-getting-started.html"><a href="2-getting-started.html#programming-concepts"><i class="fa fa-check"></i><b>2.2.1</b> Basic programming concepts needed</a></li>
<li class="chapter" data-level="2.2.2" data-path="2-getting-started.html"><a href="2-getting-started.html#tips-on-learning-to-code"><i class="fa fa-check"></i><b>2.2.2</b> Tips on learning to code</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="2-getting-started.html"><a href="2-getting-started.html#packages"><i class="fa fa-check"></i><b>2.3</b> What are R packages?</a><ul>
<li class="chapter" data-level="2.3.1" data-path="2-getting-started.html"><a href="2-getting-started.html#package-installation"><i class="fa fa-check"></i><b>2.3.1</b> Package installation</a></li>
<li class="chapter" data-level="2.3.2" data-path="2-getting-started.html"><a href="2-getting-started.html#package-loading"><i class="fa fa-check"></i><b>2.3.2</b> Package loading</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="2-getting-started.html"><a href="2-getting-started.html#nycflights13"><i class="fa fa-check"></i><b>2.4</b> Putting it all together</a><ul>
<li class="chapter" data-level="2.4.1" data-path="2-getting-started.html"><a href="2-getting-started.html#nycflights13-package"><i class="fa fa-check"></i><b>2.4.1</b> nycflights13 package</a></li>
<li class="chapter" data-level="2.4.2" data-path="2-getting-started.html"><a href="2-getting-started.html#flights-data-frame"><i class="fa fa-check"></i><b>2.4.2</b> flights data frame</a></li>
<li class="chapter" data-level="2.4.3" data-path="2-getting-started.html"><a href="2-getting-started.html#explore-dataframes"><i class="fa fa-check"></i><b>2.4.3</b> Exploring data frames</a></li>
<li class="chapter" data-level="2.4.4" data-path="2-getting-started.html"><a href="2-getting-started.html#help-files"><i class="fa fa-check"></i><b>2.4.4</b> Help files</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="2-getting-started.html"><a href="2-getting-started.html#conclusion"><i class="fa fa-check"></i><b>2.5</b> Conclusion</a><ul>
<li class="chapter" data-level="2.5.1" data-path="2-getting-started.html"><a href="2-getting-started.html#whats-to-come"><i class="fa fa-check"></i><b>2.5.1</b> What’s to come?</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>I Data Exploration via the tidyverse</b></span></li>
<li class="chapter" data-level="3" data-path="3-viz.html"><a href="3-viz.html"><i class="fa fa-check"></i><b>3</b> Data Visualization via ggplot2</a><ul>
<li class="chapter" data-level="" data-path="3-viz.html"><a href="3-viz.html#needed-packages"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="3.1" data-path="3-viz.html"><a href="3-viz.html#grammarofgraphics"><i class="fa fa-check"></i><b>3.1</b> The Grammar of Graphics</a><ul>
<li class="chapter" data-level="3.1.1" data-path="3-viz.html"><a href="3-viz.html#components-of-the-grammar"><i class="fa fa-check"></i><b>3.1.1</b> Components of the Grammar</a></li>
<li class="chapter" data-level="3.1.2" data-path="3-viz.html"><a href="3-viz.html#gapminder"><i class="fa fa-check"></i><b>3.1.2</b> Gapminder</a></li>
<li class="chapter" data-level="3.1.3" data-path="3-viz.html"><a href="3-viz.html#other-components-of-the-grammar"><i class="fa fa-check"></i><b>3.1.3</b> Other components of the Grammar</a></li>
<li class="chapter" data-level="3.1.4" data-path="3-viz.html"><a href="3-viz.html#the-ggplot2-package"><i class="fa fa-check"></i><b>3.1.4</b> The ggplot2 package</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="3-viz.html"><a href="3-viz.html#FiveNG"><i class="fa fa-check"></i><b>3.2</b> Five Named Graphs - The 5NG</a></li>
<li class="chapter" data-level="3.3" data-path="3-viz.html"><a href="3-viz.html#scatterplots"><i class="fa fa-check"></i><b>3.3</b> 5NG#1: Scatterplots</a><ul>
<li class="chapter" data-level="3.3.1" data-path="3-viz.html"><a href="3-viz.html#geompoint"><i class="fa fa-check"></i><b>3.3.1</b> Scatterplots via geom_point</a></li>
<li class="chapter" data-level="3.3.2" data-path="3-viz.html"><a href="3-viz.html#over-plotting"><i class="fa fa-check"></i><b>3.3.2</b> Over-plotting</a></li>
<li class="chapter" data-level="3.3.3" data-path="3-viz.html"><a href="3-viz.html#summary"><i class="fa fa-check"></i><b>3.3.3</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="3-viz.html"><a href="3-viz.html#linegraphs"><i class="fa fa-check"></i><b>3.4</b> 5NG#2: Linegraphs</a><ul>
<li class="chapter" data-level="3.4.1" data-path="3-viz.html"><a href="3-viz.html#geomline"><i class="fa fa-check"></i><b>3.4.1</b> Linegraphs via geom_line</a></li>
<li class="chapter" data-level="3.4.2" data-path="3-viz.html"><a href="3-viz.html#summary-1"><i class="fa fa-check"></i><b>3.4.2</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="3-viz.html"><a href="3-viz.html#histograms"><i class="fa fa-check"></i><b>3.5</b> 5NG#3: Histograms</a><ul>
<li class="chapter" data-level="3.5.1" data-path="3-viz.html"><a href="3-viz.html#geomhistogram"><i class="fa fa-check"></i><b>3.5.1</b> Histograms via geom_histogram</a></li>
<li class="chapter" data-level="3.5.2" data-path="3-viz.html"><a href="3-viz.html#adjustbins"><i class="fa fa-check"></i><b>3.5.2</b> Adjusting the bins</a></li>
<li class="chapter" data-level="3.5.3" data-path="3-viz.html"><a href="3-viz.html#summary-2"><i class="fa fa-check"></i><b>3.5.3</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="3-viz.html"><a href="3-viz.html#facets"><i class="fa fa-check"></i><b>3.6</b> Facets</a></li>
<li class="chapter" data-level="3.7" data-path="3-viz.html"><a href="3-viz.html#boxplots"><i class="fa fa-check"></i><b>3.7</b> 5NG#4: Boxplots</a><ul>
<li class="chapter" data-level="3.7.1" data-path="3-viz.html"><a href="3-viz.html#geomboxplot"><i class="fa fa-check"></i><b>3.7.1</b> Boxplots via geom_boxplot</a></li>
<li class="chapter" data-level="3.7.2" data-path="3-viz.html"><a href="3-viz.html#summary-3"><i class="fa fa-check"></i><b>3.7.2</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="3-viz.html"><a href="3-viz.html#geombar"><i class="fa fa-check"></i><b>3.8</b> 5NG#5: Barplots</a><ul>
<li class="chapter" data-level="3.8.1" data-path="3-viz.html"><a href="3-viz.html#barplots-via-geom_bargeom_col"><i class="fa fa-check"></i><b>3.8.1</b> Barplots via geom_bar/geom_col</a></li>
<li class="chapter" data-level="3.8.2" data-path="3-viz.html"><a href="3-viz.html#must-avoid-pie-charts"><i class="fa fa-check"></i><b>3.8.2</b> Must avoid pie charts!</a></li>
<li class="chapter" data-level="3.8.3" data-path="3-viz.html"><a href="3-viz.html#using-barplots-to-compare-two-categorical-variables"><i class="fa fa-check"></i><b>3.8.3</b> Using barplots to compare two categorical variables</a></li>
<li class="chapter" data-level="3.8.4" data-path="3-viz.html"><a href="3-viz.html#summary-4"><i class="fa fa-check"></i><b>3.8.4</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="3-viz.html"><a href="3-viz.html#conclusion-1"><i class="fa fa-check"></i><b>3.9</b> Conclusion</a><ul>
<li class="chapter" data-level="3.9.1" data-path="3-viz.html"><a href="3-viz.html#review-questions"><i class="fa fa-check"></i><b>3.9.1</b> Review questions</a></li>
<li class="chapter" data-level="3.9.2" data-path="3-viz.html"><a href="3-viz.html#whats-to-come-1"><i class="fa fa-check"></i><b>3.9.2</b> What’s to come?</a></li>
<li class="chapter" data-level="3.9.3" data-path="3-viz.html"><a href="3-viz.html#resources"><i class="fa fa-check"></i><b>3.9.3</b> Resources</a></li>
<li class="chapter" data-level="3.9.4" data-path="3-viz.html"><a href="3-viz.html#script-of-r-code"><i class="fa fa-check"></i><b>3.9.4</b> Script of R code</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="4-tidy.html"><a href="4-tidy.html"><i class="fa fa-check"></i><b>4</b> Data Tidying via tidyr</a><ul>
<li class="chapter" data-level="" data-path="4-tidy.html"><a href="4-tidy.html#needed-packages-1"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="4.1" data-path="4-tidy.html"><a href="4-tidy.html#what-is-tidy-data"><i class="fa fa-check"></i><b>4.1</b> What is tidy data?</a></li>
<li class="chapter" data-level="4.2" data-path="4-tidy.html"><a href="4-tidy.html#importing-csvs-via-readr"><i class="fa fa-check"></i><b>4.2</b> Importing CSVs via readr</a></li>
<li class="chapter" data-level="4.3" data-path="4-tidy.html"><a href="4-tidy.html#tidying"><i class="fa fa-check"></i><b>4.3</b> Converting from wide to long</a></li>
<li class="chapter" data-level="4.4" data-path="4-tidy.html"><a href="4-tidy.html#back-to-nycflights"><i class="fa fa-check"></i><b>4.4</b> Back to nycflights</a><ul>
<li class="chapter" data-level="4.4.1" data-path="4-tidy.html"><a href="4-tidy.html#observational-units"><i class="fa fa-check"></i><b>4.4.1</b> Observational units</a></li>
<li class="chapter" data-level="4.4.2" data-path="4-tidy.html"><a href="4-tidy.html#identification-vs-measurement-variables"><i class="fa fa-check"></i><b>4.4.2</b> Identification vs measurement variables</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="4-tidy.html"><a href="4-tidy.html#optional-normal-forms-of-data"><i class="fa fa-check"></i><b>4.5</b> Optional: Normal forms of data</a></li>
<li class="chapter" data-level="4.6" data-path="4-tidy.html"><a href="4-tidy.html#conclusion-2"><i class="fa fa-check"></i><b>4.6</b> Conclusion</a><ul>
<li class="chapter" data-level="4.6.1" data-path="4-tidy.html"><a href="4-tidy.html#review-questions-1"><i class="fa fa-check"></i><b>4.6.1</b> Review questions</a></li>
<li class="chapter" data-level="4.6.2" data-path="4-tidy.html"><a href="4-tidy.html#whats-to-come-2"><i class="fa fa-check"></i><b>4.6.2</b> What’s to come?</a></li>
<li class="chapter" data-level="4.6.3" data-path="4-tidy.html"><a href="4-tidy.html#script-of-r-code-1"><i class="fa fa-check"></i><b>4.6.3</b> Script of R code</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="5-wrangling.html"><a href="5-wrangling.html"><i class="fa fa-check"></i><b>5</b> Data Wrangling via dplyr</a><ul>
<li class="chapter" data-level="" data-path="5-wrangling.html"><a href="5-wrangling.html#needed-packages-2"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="5.1" data-path="5-wrangling.html"><a href="5-wrangling.html#the-pipe"><i class="fa fa-check"></i><b>5.1</b> The pipe <code>%&gt;%</code></a></li>
<li class="chapter" data-level="5.2" data-path="5-wrangling.html"><a href="5-wrangling.html#five-main-verbs---the-5mv"><i class="fa fa-check"></i><b>5.2</b> Five Main Verbs - The 5MV</a><ul>
<li class="chapter" data-level="5.2.1" data-path="5-wrangling.html"><a href="5-wrangling.html#filter"><i class="fa fa-check"></i><b>5.2.1</b> 5MV#1: Filter observations using filter</a></li>
<li class="chapter" data-level="5.2.2" data-path="5-wrangling.html"><a href="5-wrangling.html#mv2-summarize-variables-using-summarize"><i class="fa fa-check"></i><b>5.2.2</b> 5MV#2: Summarize variables using summarize</a></li>
<li class="chapter" data-level="5.2.3" data-path="5-wrangling.html"><a href="5-wrangling.html#groupby"><i class="fa fa-check"></i><b>5.2.3</b> 5MV#3: Group rows using group_by</a></li>
<li class="chapter" data-level="5.2.4" data-path="5-wrangling.html"><a href="5-wrangling.html#mv4-create-new-variableschange-old-variables-using-mutate"><i class="fa fa-check"></i><b>5.2.4</b> 5MV#4: Create new variables/change old variables using mutate</a></li>
<li class="chapter" data-level="5.2.5" data-path="5-wrangling.html"><a href="5-wrangling.html#arrange"><i class="fa fa-check"></i><b>5.2.5</b> 5MV#5: Reorder the data frame using arrange</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="5-wrangling.html"><a href="5-wrangling.html#joins"><i class="fa fa-check"></i><b>5.3</b> Joining data frames</a><ul>
<li class="chapter" data-level="5.3.1" data-path="5-wrangling.html"><a href="5-wrangling.html#joining-by-key-variables"><i class="fa fa-check"></i><b>5.3.1</b> Joining by key variables</a></li>
<li class="chapter" data-level="5.3.2" data-path="5-wrangling.html"><a href="5-wrangling.html#joining-by-key-variables-with-different-names"><i class="fa fa-check"></i><b>5.3.2</b> Joining by key variables with different names</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="5-wrangling.html"><a href="5-wrangling.html#other-verbs"><i class="fa fa-check"></i><b>5.4</b> Optional: Other verbs</a><ul>
<li class="chapter" data-level="5.4.1" data-path="5-wrangling.html"><a href="5-wrangling.html#select"><i class="fa fa-check"></i><b>5.4.1</b> Select variables using select</a></li>
<li class="chapter" data-level="5.4.2" data-path="5-wrangling.html"><a href="5-wrangling.html#rename"><i class="fa fa-check"></i><b>5.4.2</b> Rename variables using rename</a></li>
<li class="chapter" data-level="5.4.3" data-path="5-wrangling.html"><a href="5-wrangling.html#find-the-top-number-of-values-using-top_n"><i class="fa fa-check"></i><b>5.4.3</b> Find the top number of values using top_n</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="5-wrangling.html"><a href="5-wrangling.html#conclusion-3"><i class="fa fa-check"></i><b>5.5</b> Conclusion</a><ul>
<li class="chapter" data-level="5.5.1" data-path="5-wrangling.html"><a href="5-wrangling.html#review-questions-2"><i class="fa fa-check"></i><b>5.5.1</b> Review questions</a></li>
<li class="chapter" data-level="5.5.2" data-path="5-wrangling.html"><a href="5-wrangling.html#whats-to-come-3"><i class="fa fa-check"></i><b>5.5.2</b> What’s to come?</a></li>
<li class="chapter" data-level="5.5.3" data-path="5-wrangling.html"><a href="5-wrangling.html#resources-1"><i class="fa fa-check"></i><b>5.5.3</b> Resources</a></li>
<li class="chapter" data-level="5.5.4" data-path="5-wrangling.html"><a href="5-wrangling.html#script-of-r-code-2"><i class="fa fa-check"></i><b>5.5.4</b> Script of R code</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="6-regression.html"><a href="6-regression.html"><i class="fa fa-check"></i><b>6</b> Data Modeling with Regression</a><ul>
<li class="chapter" data-level="" data-path="6-regression.html"><a href="6-regression.html#needed-packages-3"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="6.1" data-path="6-regression.html"><a href="6-regression.html#datasets"><i class="fa fa-check"></i><b>6.1</b> Datasets</a><ul>
<li class="chapter" data-level="6.1.1" data-path="6-regression.html"><a href="6-regression.html#profevals"><i class="fa fa-check"></i><b>6.1.1</b> Professor evaluations</a></li>
<li class="chapter" data-level="6.1.2" data-path="6-regression.html"><a href="6-regression.html#datalifeexp"><i class="fa fa-check"></i><b>6.1.2</b> Country-by-country life expectancies in 2007</a></li>
<li class="chapter" data-level="6.1.3" data-path="6-regression.html"><a href="6-regression.html#datacreditcard"><i class="fa fa-check"></i><b>6.1.3</b> Credit card balance</a></li>
<li class="chapter" data-level="6.1.4" data-path="6-regression.html"><a href="6-regression.html#biopics"><i class="fa fa-check"></i><b>6.1.4</b> Biopics</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="6-regression.html"><a href="6-regression.html#onenumerical"><i class="fa fa-check"></i><b>6.2</b> One numerical x: Professor evaluations</a><ul>
<li class="chapter" data-level="6.2.1" data-path="6-regression.html"><a href="6-regression.html#exploratory-data-analysis"><i class="fa fa-check"></i><b>6.2.1</b> Exploratory data analysis</a></li>
<li class="chapter" data-level="6.2.2" data-path="6-regression.html"><a href="6-regression.html#correlation-coefficient"><i class="fa fa-check"></i><b>6.2.2</b> Correlation coefficient</a></li>
<li class="chapter" data-level="6.2.3" data-path="6-regression.html"><a href="6-regression.html#simple-linear-regression"><i class="fa fa-check"></i><b>6.2.3</b> Simple linear regression</a></li>
<li class="chapter" data-level="6.2.4" data-path="6-regression.html"><a href="6-regression.html#observed-values-fitted-values-and-residuals"><i class="fa fa-check"></i><b>6.2.4</b> Observed values, fitted values, and residuals</a></li>
<li class="chapter" data-level="6.2.5" data-path="6-regression.html"><a href="6-regression.html#residual_analysis"><i class="fa fa-check"></i><b>6.2.5</b> Residual analysis</a></li>
<li class="chapter" data-level="6.2.6" data-path="6-regression.html"><a href="6-regression.html#best-fitting-lines"><i class="fa fa-check"></i><b>6.2.6</b> Best fitting lines</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="6-regression.html"><a href="6-regression.html#one-categorical-x-worldwide-life-expectancy"><i class="fa fa-check"></i><b>6.3</b> One categorical x: Worldwide life expectancy</a><ul>
<li class="chapter" data-level="6.3.1" data-path="6-regression.html"><a href="6-regression.html#exploratory-data-analysis-1"><i class="fa fa-check"></i><b>6.3.1</b> Exploratory data analysis</a></li>
<li class="chapter" data-level="6.3.2" data-path="6-regression.html"><a href="6-regression.html#simple-linear-regression-1"><i class="fa fa-check"></i><b>6.3.2</b> Simple linear regression</a></li>
<li class="chapter" data-level="6.3.3" data-path="6-regression.html"><a href="6-regression.html#observed-values-fitted-values-and-residuals-1"><i class="fa fa-check"></i><b>6.3.3</b> Observed values, fitted values, and residuals</a></li>
<li class="chapter" data-level="6.3.4" data-path="6-regression.html"><a href="6-regression.html#residual-analysis"><i class="fa fa-check"></i><b>6.3.4</b> Residual analysis</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="6-regression.html"><a href="6-regression.html#two-numerical-x-credit-card-balance"><i class="fa fa-check"></i><b>6.4</b> Two numerical x: Credit card balance</a><ul>
<li class="chapter" data-level="6.4.1" data-path="6-regression.html"><a href="6-regression.html#exploratory-data-analysis-2"><i class="fa fa-check"></i><b>6.4.1</b> Exploratory data analysis</a></li>
<li class="chapter" data-level="6.4.2" data-path="6-regression.html"><a href="6-regression.html#multiple-regression"><i class="fa fa-check"></i><b>6.4.2</b> Multiple regression</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="6-regression.html"><a href="6-regression.html#one-numerical-x-and-one-categorical-x-professor-evaluations"><i class="fa fa-check"></i><b>6.5</b> One numerical x and one categorical x: Professor evaluations</a><ul>
<li class="chapter" data-level="6.5.1" data-path="6-regression.html"><a href="6-regression.html#exploratory-data-analysis-3"><i class="fa fa-check"></i><b>6.5.1</b> Exploratory data analysis</a></li>
<li class="chapter" data-level="6.5.2" data-path="6-regression.html"><a href="6-regression.html#multiple-regression-1"><i class="fa fa-check"></i><b>6.5.2</b> Multiple regression</a></li>
<li class="chapter" data-level="6.5.3" data-path="6-regression.html"><a href="6-regression.html#interaction-effects"><i class="fa fa-check"></i><b>6.5.3</b> Interaction effects</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="6-regression.html"><a href="6-regression.html#two-categorical-x-biopics"><i class="fa fa-check"></i><b>6.6</b> Two categorical x: Biopics</a><ul>
<li class="chapter" data-level="6.6.1" data-path="6-regression.html"><a href="6-regression.html#log-transformations"><i class="fa fa-check"></i><b>6.6.1</b> log-transformations</a></li>
<li class="chapter" data-level="6.6.2" data-path="6-regression.html"><a href="6-regression.html#exploratory-data-analysis-4"><i class="fa fa-check"></i><b>6.6.2</b> Exploratory data analysis</a></li>
<li class="chapter" data-level="6.6.3" data-path="6-regression.html"><a href="6-regression.html#multiple-regression-2"><i class="fa fa-check"></i><b>6.6.3</b> Multiple regression</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Inference</b></span></li>
<li class="chapter" data-level="7" data-path="7-sampling.html"><a href="7-sampling.html"><i class="fa fa-check"></i><b>7</b> Sampling</a><ul>
<li class="chapter" data-level="" data-path="7-sampling.html"><a href="7-sampling.html#needed-packages-4"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="7.1" data-path="7-sampling.html"><a href="7-sampling.html#experiment"><i class="fa fa-check"></i><b>7.1</b> Experiment</a></li>
<li class="chapter" data-level="7.2" data-path="7-sampling.html"><a href="7-sampling.html#definitions"><i class="fa fa-check"></i><b>7.2</b> Definitions</a></li>
<li class="chapter" data-level="7.3" data-path="7-sampling.html"><a href="7-sampling.html#representative-sampling"><i class="fa fa-check"></i><b>7.3</b> Representative sampling</a><ul>
<li class="chapter" data-level="7.3.1" data-path="7-sampling.html"><a href="7-sampling.html#kinsey-reports"><i class="fa fa-check"></i><b>7.3.1</b> Kinsey Reports</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="A-appendixA.html"><a href="A-appendixA.html"><i class="fa fa-check"></i><b>A</b> Statistical Background</a><ul>
<li class="chapter" data-level="A.1" data-path="A-appendixA.html"><a href="A-appendixA.html#basic-statistical-terms"><i class="fa fa-check"></i><b>A.1</b> Basic statistical terms</a><ul>
<li class="chapter" data-level="A.1.1" data-path="A-appendixA.html"><a href="A-appendixA.html#mean"><i class="fa fa-check"></i><b>A.1.1</b> Mean</a></li>
<li class="chapter" data-level="A.1.2" data-path="A-appendixA.html"><a href="A-appendixA.html#median"><i class="fa fa-check"></i><b>A.1.2</b> Median</a></li>
<li class="chapter" data-level="A.1.3" data-path="A-appendixA.html"><a href="A-appendixA.html#standard-deviation"><i class="fa fa-check"></i><b>A.1.3</b> Standard deviation</a></li>
<li class="chapter" data-level="A.1.4" data-path="A-appendixA.html"><a href="A-appendixA.html#five-number-summary"><i class="fa fa-check"></i><b>A.1.4</b> Five-number summary</a></li>
<li class="chapter" data-level="A.1.5" data-path="A-appendixA.html"><a href="A-appendixA.html#distribution"><i class="fa fa-check"></i><b>A.1.5</b> Distribution</a></li>
<li class="chapter" data-level="A.1.6" data-path="A-appendixA.html"><a href="A-appendixA.html#outliers"><i class="fa fa-check"></i><b>A.1.6</b> Outliers</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="B" data-path="B-appendixB.html"><a href="B-appendixB.html"><i class="fa fa-check"></i><b>B</b> Inference Examples</a><ul>
<li class="chapter" data-level="" data-path="B-appendixB.html"><a href="B-appendixB.html#needed-packages-5"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="B.1" data-path="B-appendixB.html"><a href="B-appendixB.html#inference-mind-map"><i class="fa fa-check"></i><b>B.1</b> Inference mind map</a></li>
<li class="chapter" data-level="B.2" data-path="B-appendixB.html"><a href="B-appendixB.html#one-mean"><i class="fa fa-check"></i><b>B.2</b> One mean</a><ul>
<li class="chapter" data-level="B.2.1" data-path="B-appendixB.html"><a href="B-appendixB.html#problem-statement"><i class="fa fa-check"></i><b>B.2.1</b> Problem statement</a></li>
<li class="chapter" data-level="B.2.2" data-path="B-appendixB.html"><a href="B-appendixB.html#competing-hypotheses"><i class="fa fa-check"></i><b>B.2.2</b> Competing hypotheses</a></li>
<li class="chapter" data-level="B.2.3" data-path="B-appendixB.html"><a href="B-appendixB.html#exploring-the-sample-data"><i class="fa fa-check"></i><b>B.2.3</b> Exploring the sample data</a></li>
<li class="chapter" data-level="B.2.4" data-path="B-appendixB.html"><a href="B-appendixB.html#non-traditional-methods"><i class="fa fa-check"></i><b>B.2.4</b> Non-traditional methods</a></li>
<li class="chapter" data-level="B.2.5" data-path="B-appendixB.html"><a href="B-appendixB.html#traditional-methods"><i class="fa fa-check"></i><b>B.2.5</b> Traditional methods</a></li>
<li class="chapter" data-level="B.2.6" data-path="B-appendixB.html"><a href="B-appendixB.html#comparing-results"><i class="fa fa-check"></i><b>B.2.6</b> Comparing results</a></li>
</ul></li>
<li class="chapter" data-level="B.3" data-path="B-appendixB.html"><a href="B-appendixB.html#one-proportion"><i class="fa fa-check"></i><b>B.3</b> One proportion</a><ul>
<li class="chapter" data-level="B.3.1" data-path="B-appendixB.html"><a href="B-appendixB.html#problem-statement-1"><i class="fa fa-check"></i><b>B.3.1</b> Problem statement</a></li>
<li class="chapter" data-level="B.3.2" data-path="B-appendixB.html"><a href="B-appendixB.html#competing-hypotheses-1"><i class="fa fa-check"></i><b>B.3.2</b> Competing hypotheses</a></li>
<li class="chapter" data-level="B.3.3" data-path="B-appendixB.html"><a href="B-appendixB.html#exploring-the-sample-data-1"><i class="fa fa-check"></i><b>B.3.3</b> Exploring the sample data</a></li>
<li class="chapter" data-level="B.3.4" data-path="B-appendixB.html"><a href="B-appendixB.html#non-traditional-methods-1"><i class="fa fa-check"></i><b>B.3.4</b> Non-traditional methods</a></li>
<li class="chapter" data-level="B.3.5" data-path="B-appendixB.html"><a href="B-appendixB.html#traditional-methods-1"><i class="fa fa-check"></i><b>B.3.5</b> Traditional methods</a></li>
<li class="chapter" data-level="B.3.6" data-path="B-appendixB.html"><a href="B-appendixB.html#comparing-results-1"><i class="fa fa-check"></i><b>B.3.6</b> Comparing results</a></li>
</ul></li>
<li class="chapter" data-level="B.4" data-path="B-appendixB.html"><a href="B-appendixB.html#two-proportions"><i class="fa fa-check"></i><b>B.4</b> Two proportions</a><ul>
<li class="chapter" data-level="B.4.1" data-path="B-appendixB.html"><a href="B-appendixB.html#problem-statement-2"><i class="fa fa-check"></i><b>B.4.1</b> Problem statement</a></li>
<li class="chapter" data-level="B.4.2" data-path="B-appendixB.html"><a href="B-appendixB.html#competing-hypotheses-2"><i class="fa fa-check"></i><b>B.4.2</b> Competing hypotheses</a></li>
<li class="chapter" data-level="B.4.3" data-path="B-appendixB.html"><a href="B-appendixB.html#exploring-the-sample-data-2"><i class="fa fa-check"></i><b>B.4.3</b> Exploring the sample data</a></li>
<li class="chapter" data-level="B.4.4" data-path="B-appendixB.html"><a href="B-appendixB.html#non-traditional-methods-2"><i class="fa fa-check"></i><b>B.4.4</b> Non-traditional methods</a></li>
<li class="chapter" data-level="B.4.5" data-path="B-appendixB.html"><a href="B-appendixB.html#traditional-methods-2"><i class="fa fa-check"></i><b>B.4.5</b> Traditional methods</a></li>
<li class="chapter" data-level="B.4.6" data-path="B-appendixB.html"><a href="B-appendixB.html#check-conditions-2"><i class="fa fa-check"></i><b>B.4.6</b> Check conditions</a></li>
<li class="chapter" data-level="B.4.7" data-path="B-appendixB.html"><a href="B-appendixB.html#test-statistic-2"><i class="fa fa-check"></i><b>B.4.7</b> Test statistic</a></li>
<li class="chapter" data-level="B.4.8" data-path="B-appendixB.html"><a href="B-appendixB.html#state-conclusion-2"><i class="fa fa-check"></i><b>B.4.8</b> State conclusion</a></li>
<li class="chapter" data-level="B.4.9" data-path="B-appendixB.html"><a href="B-appendixB.html#comparing-results-2"><i class="fa fa-check"></i><b>B.4.9</b> Comparing results</a></li>
</ul></li>
<li class="chapter" data-level="B.5" data-path="B-appendixB.html"><a href="B-appendixB.html#two-means-independent-samples"><i class="fa fa-check"></i><b>B.5</b> Two means (independent samples)</a><ul>
<li class="chapter" data-level="B.5.1" data-path="B-appendixB.html"><a href="B-appendixB.html#problem-statement-3"><i class="fa fa-check"></i><b>B.5.1</b> Problem statement</a></li>
<li class="chapter" data-level="B.5.2" data-path="B-appendixB.html"><a href="B-appendixB.html#competing-hypotheses-3"><i class="fa fa-check"></i><b>B.5.2</b> Competing hypotheses</a></li>
<li class="chapter" data-level="B.5.3" data-path="B-appendixB.html"><a href="B-appendixB.html#exploring-the-sample-data-3"><i class="fa fa-check"></i><b>B.5.3</b> Exploring the sample data</a></li>
<li class="chapter" data-level="B.5.4" data-path="B-appendixB.html"><a href="B-appendixB.html#non-traditional-methods-3"><i class="fa fa-check"></i><b>B.5.4</b> Non-traditional methods</a></li>
<li class="chapter" data-level="B.5.5" data-path="B-appendixB.html"><a href="B-appendixB.html#traditional-methods-3"><i class="fa fa-check"></i><b>B.5.5</b> Traditional methods</a></li>
<li class="chapter" data-level="B.5.6" data-path="B-appendixB.html"><a href="B-appendixB.html#test-statistic-3"><i class="fa fa-check"></i><b>B.5.6</b> Test statistic</a></li>
<li class="chapter" data-level="B.5.7" data-path="B-appendixB.html"><a href="B-appendixB.html#compute-p-value-2"><i class="fa fa-check"></i><b>B.5.7</b> Compute <span class="math inline">\(p\)</span>-value</a></li>
<li class="chapter" data-level="B.5.8" data-path="B-appendixB.html"><a href="B-appendixB.html#state-conclusion-3"><i class="fa fa-check"></i><b>B.5.8</b> State conclusion</a></li>
<li class="chapter" data-level="B.5.9" data-path="B-appendixB.html"><a href="B-appendixB.html#comparing-results-3"><i class="fa fa-check"></i><b>B.5.9</b> Comparing results</a></li>
</ul></li>
<li class="chapter" data-level="B.6" data-path="B-appendixB.html"><a href="B-appendixB.html#two-means-paired-samples"><i class="fa fa-check"></i><b>B.6</b> Two means (paired samples)</a><ul>
<li class="chapter" data-level="B.6.1" data-path="B-appendixB.html"><a href="B-appendixB.html#competing-hypotheses-4"><i class="fa fa-check"></i><b>B.6.1</b> Competing hypotheses</a></li>
<li class="chapter" data-level="B.6.2" data-path="B-appendixB.html"><a href="B-appendixB.html#exploring-the-sample-data-4"><i class="fa fa-check"></i><b>B.6.2</b> Exploring the sample data</a></li>
<li class="chapter" data-level="B.6.3" data-path="B-appendixB.html"><a href="B-appendixB.html#non-traditional-methods-4"><i class="fa fa-check"></i><b>B.6.3</b> Non-traditional methods</a></li>
<li class="chapter" data-level="B.6.4" data-path="B-appendixB.html"><a href="B-appendixB.html#traditional-methods-4"><i class="fa fa-check"></i><b>B.6.4</b> Traditional methods</a></li>
<li class="chapter" data-level="B.6.5" data-path="B-appendixB.html"><a href="B-appendixB.html#comparing-results-4"><i class="fa fa-check"></i><b>B.6.5</b> Comparing results</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="C" data-path="C-appendixC.html"><a href="C-appendixC.html"><i class="fa fa-check"></i><b>C</b> Reach for the Stars</a><ul>
<li class="chapter" data-level="" data-path="C-appendixC.html"><a href="C-appendixC.html#needed-packages-6"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="C.1" data-path="C-appendixC.html"><a href="C-appendixC.html#sorted-barplots"><i class="fa fa-check"></i><b>C.1</b> Sorted barplots</a></li>
<li class="chapter" data-level="C.2" data-path="C-appendixC.html"><a href="C-appendixC.html#interactive-graphics"><i class="fa fa-check"></i><b>C.2</b> Interactive graphics</a><ul>
<li class="chapter" data-level="C.2.1" data-path="C-appendixC.html"><a href="C-appendixC.html#interactive-linegraphs"><i class="fa fa-check"></i><b>C.2.1</b> Interactive linegraphs</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">An Introduction to Statistical and Data Sciences via R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<html>
<img src='http://moderndive.com/images/logos/wide_format.png' alt="ModernDive">
</html>
<div id="regression" class="section level1">
<h1><span class="header-section-number">6</span> Data Modeling with Regression</h1>
<p>Now that we are equipped with data visualization skills from Chapter <a href="3-viz.html#viz">3</a>, data wrangling skills from Chapter <a href="5-wrangling.html#wrangling">5</a>, and an understanding of the “tidy” data format from Chapter <a href="4-tidy.html#tidy">4</a>, we now proceed to discuss once of the most commonly used statistical procedures: <em>regression</em>. Much as we saw with the Grammar of Graphics in Chapter <a href="3-viz.html#viz">3</a>, the fundamental premise of (simple linear) regression is to <em>model</em> the relationship between</p>
<ul>
<li>An outcome/dependent/predicted variable <span class="math inline">\(y\)</span></li>
<li>As a function of a covariate/independent/predictor variable <span class="math inline">\(x\)</span></li>
</ul>
<p>Why do we have multiple labels for the same concept? What’s their root? Regression, in its simplest form, can be viewed in two ways:</p>
<ol style="list-style-type: decimal">
<li><strong>For Prediction</strong>: You want to predict an outcome variable <span class="math inline">\(y\)</span> based on the information contained in a set of predictor variables. You don’t care so much about understanding how all the variables relate and interact, but so long as you can make good predictions about <span class="math inline">\(y\)</span>, you’re fine.</li>
<li><strong>For Explanation</strong>: You want to study the relationship between an outcome variable <span class="math inline">\(y\)</span> and a set of explanatory variables, determine the significance of any found relationships, and have measures summarizing these.</li>
</ol>
<p>In this chapter, we use the <code>flights</code> data frame in the <code>nycflights13</code> package to look at the relationship between departure delay, arrival delay, and other variables related to flights. We will also discuss the concept of <em>correlation</em> and how it is frequently incorrectly implied to also lead to <em>causation</em>. This chapter also introduces the <code>broom</code> package, which is a useful tool for summarizing the results of regression fits in “tidy” format.</p>
<div id="needed-packages-3" class="section level3 unnumbered">
<h3>Needed packages</h3>
<p>Let’s load all the packages needed for this chapter (this assumes you’ve already installed them). If needed, read Section <a href="2-getting-started.html#packages">2.3</a> for information on how to install and load R packages.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(nycflights13)
<span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(dplyr)
<span class="kw">library</span>(broom)</code></pre></div>
</div>
<div id="datasets" class="section level2">
<h2><span class="header-section-number">6.1</span> Datasets</h2>
<div id="profevals" class="section level3">
<h3><span class="header-section-number">6.1.1</span> Professor evaluations</h3>
<p>A study conducted at the University of Texas in Austin available at <a href="https://www.openintro.org/stat/data/?data=evals">openintro.org</a> investigated associations between teacher evalutions and various attributes of the instructor.</p>
<ul>
<li><strong>Question</strong>: Can we explain a professor’s teaching evaluation score using these attritubes?</li>
<li>Outcome variable <span class="math inline">\(y\)</span>: Average teaching score, based on students evaluations between 1 and 5</li>
<li>Explanatory variables <span class="math inline">\(x\)</span>
<ul>
<li>their rank: teaching, tenure track, or tenured</li>
<li>their ethnicity: minority or non-minority</li>
<li>their (binary) gender: male or female</li>
<li>their language: whether or not english was their mother tongue</li>
<li>their age:</li>
<li>their average “beauty” rating, based on a panel of 6 students’ scores between 1 and 10.</li>
</ul></li>
</ul>
<p>First let’s load the data and look at a random sample of 5 rows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">load</span>(<span class="kw">url</span>(<span class="st">&quot;http://www.openintro.org/stat/data/evals.RData&quot;</span>))
evals &lt;-<span class="st"> </span>evals <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(score, ethnicity, gender, language, age, bty_avg, rank)</code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-140">Table 6.1: </span>Random sample of 5 instructors</caption>
<thead>
<tr class="header">
<th></th>
<th align="right">score</th>
<th align="left">ethnicity</th>
<th align="left">gender</th>
<th align="left">language</th>
<th align="right">age</th>
<th align="right">bty_avg</th>
<th align="left">rank</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>14</td>
<td align="right">3.9</td>
<td align="left">not minority</td>
<td align="left">female</td>
<td align="left">english</td>
<td align="right">40</td>
<td align="right">3.17</td>
<td align="left">tenured</td>
</tr>
<tr class="even">
<td>150</td>
<td align="right">3.5</td>
<td align="left">minority</td>
<td align="left">male</td>
<td align="left">non-english</td>
<td align="right">52</td>
<td align="right">4.83</td>
<td align="left">tenured</td>
</tr>
<tr class="odd">
<td>325</td>
<td align="right">4.2</td>
<td align="left">not minority</td>
<td align="left">female</td>
<td align="left">english</td>
<td align="right">52</td>
<td align="right">2.33</td>
<td align="left">teaching</td>
</tr>
<tr class="even">
<td>212</td>
<td align="right">4.6</td>
<td align="left">not minority</td>
<td align="left">male</td>
<td align="left">english</td>
<td align="right">60</td>
<td align="right">3.67</td>
<td align="left">tenured</td>
</tr>
<tr class="odd">
<td>152</td>
<td align="right">3.6</td>
<td align="left">minority</td>
<td align="left">male</td>
<td align="left">non-english</td>
<td align="right">52</td>
<td align="right">4.83</td>
<td align="left">tenured</td>
</tr>
</tbody>
</table>
</div>
<div id="datalifeexp" class="section level3">
<h3><span class="header-section-number">6.1.2</span> Country-by-country life expectancies in 2007</h3>
<p>The <code>gapminder</code> package contains the <code>gapminder</code> data frame, which contains development data about various countries for 5-year intervals between 1952 and 2007</p>
<ul>
<li><strong>Question</strong>: What variables are associated with life expectancy for all countries in 2007? In other words, can we identify variables that can explain variation in life expectancy between countries.</li>
<li>Outcome variable <span class="math inline">\(y\)</span>: Mean life expectancy</li>
<li>Explanatory variables <span class="math inline">\(x\)</span>
<ul>
<li>continent</li>
<li>GDP per capita</li>
</ul></li>
</ul>
<p>First let’s load the data and look at a random sample of 5 rows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(gapminder)
gapminder2007 &lt;-<span class="st"> </span>gapminder <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(year <span class="op">==</span><span class="st"> </span><span class="dv">2007</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">select</span>(country, lifeExp, continent, gdpPercap)</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">country</th>
<th align="right">lifeExp</th>
<th align="left">continent</th>
<th align="right">gdpPercap</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Bulgaria</td>
<td align="right">73.0</td>
<td align="left">Europe</td>
<td align="right">10680.8</td>
</tr>
<tr class="even">
<td align="left">Singapore</td>
<td align="right">80.0</td>
<td align="left">Asia</td>
<td align="right">47143.2</td>
</tr>
<tr class="odd">
<td align="left">Australia</td>
<td align="right">81.2</td>
<td align="left">Oceania</td>
<td align="right">34435.4</td>
</tr>
<tr class="even">
<td align="left">Rwanda</td>
<td align="right">46.2</td>
<td align="left">Africa</td>
<td align="right">863.1</td>
</tr>
<tr class="odd">
<td align="left">Bahrain</td>
<td align="right">75.6</td>
<td align="left">Asia</td>
<td align="right">29796.0</td>
</tr>
</tbody>
</table>
</div>
<div id="datacreditcard" class="section level3">
<h3><span class="header-section-number">6.1.3</span> Credit card balance</h3>
<p>The <code>ISLR</code> package contains the <code>Credit</code> data frame, which contains information on Credit balances. Unfortunately, I don’t have information on which population this data was drawn from, so we can’t generalize any of these results.</p>
<ul>
<li><strong>Question</strong>: What variables are associated with how much credit card debt an individual has</li>
<li>Outcome variable <span class="math inline">\(y\)</span> <code>Balance</code></li>
<li>Explanatory variables
<ul>
<li><span class="math inline">\(x_1\)</span> <code>Income</code>: Income in $1000’s</li>
<li><span class="math inline">\(x_2\)</span> <code>Limit</code>: Credit limit</li>
</ul></li>
</ul>
<p>First let’s load the data and look at a random sample of 5 rows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ISLR)
Credit &lt;-<span class="st"> </span>Credit <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(Balance, Income, Limit)</code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">Balance</th>
<th align="right">Income</th>
<th align="right">Limit</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>379</td>
<td align="right">717</td>
<td align="right">19.3</td>
<td align="right">4941</td>
</tr>
<tr class="even">
<td>31</td>
<td align="right">863</td>
<td align="right">34.1</td>
<td align="right">5666</td>
</tr>
<tr class="odd">
<td>137</td>
<td align="right">75</td>
<td align="right">54.7</td>
<td align="right">4116</td>
</tr>
<tr class="even">
<td>48</td>
<td align="right">797</td>
<td align="right">44.6</td>
<td align="right">4431</td>
</tr>
<tr class="odd">
<td>390</td>
<td align="right">806</td>
<td align="right">83.9</td>
<td align="right">7100</td>
</tr>
</tbody>
</table>
</div>
<div id="biopics" class="section level3">
<h3><span class="header-section-number">6.1.4</span> Biopics</h3>
<p>Let’s look at the <code>biopics</code> dataset in the <a href="https://rudeboybert.github.io/fivethirtyeight/"><code>fivethirtyeight</code></a> package. After loading the package, run <code>?biopics</code> in the console to read the help file. This data is from the article <a href="https://fivethirtyeight.com/features/straight-outta-compton-is-the-rare-biopic-not-about-white-dudes/">“Straight Outta Compton” Is The Rare Biopic Not About White Dudes</a>.</p>
<p>First let’s load the data and look at a random sample of 5 rows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(fivethirtyeight)
biopics &lt;-<span class="st"> </span>biopics <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">select</span>(title, box_office, person_of_color, subject_sex) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co"># Remove those that are missing</span>
<span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(box_office))</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">title</th>
<th align="right">box_office</th>
<th align="left">person_of_color</th>
<th align="left">subject_sex</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">The King’s Speech</td>
<td align="right">139000000</td>
<td align="left">FALSE</td>
<td align="left">Male</td>
</tr>
<tr class="even">
<td align="left">Veronica Guerin</td>
<td align="right">1570000</td>
<td align="left">FALSE</td>
<td align="left">Female</td>
</tr>
<tr class="odd">
<td align="left">The First Grader</td>
<td align="right">331000</td>
<td align="left">TRUE</td>
<td align="left">Male</td>
</tr>
<tr class="even">
<td align="left">Creation</td>
<td align="right">341000</td>
<td align="left">FALSE</td>
<td align="left">Male</td>
</tr>
<tr class="odd">
<td align="left">84 Charing Cross Road</td>
<td align="right">1080000</td>
<td align="left">FALSE</td>
<td align="left">Female</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="onenumerical" class="section level2">
<h2><span class="header-section-number">6.2</span> One numerical x: Professor evaluations</h2>
<div id="exploratory-data-analysis" class="section level3">
<h3><span class="header-section-number">6.2.1</span> Exploratory data analysis</h3>
<p>Let’s</p>
<ul>
<li>Model the outcome variable y: teacher evaluation score</li>
<li>Using explanatory variable x: beauty score</li>
</ul>
<p>Let’s plot the data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(evals, <span class="kw">aes</span>(<span class="dt">x=</span>bty_avg, <span class="dt">y=</span>score)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;Beauty Score&quot;</span>, <span class="dt">y=</span><span class="st">&quot;Teaching Score&quot;</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:numxplot1"></span>
<img src="ismaykim_files/figure-html/numxplot1-1.png" alt="Teacher evaluation scores at UT Austin" width="\textwidth" />
<p class="caption">
Figure 6.1: Teacher evaluation scores at UT Austin
</p>
</div>
<p>The above suffers from <em>overplotting</em>; let’s break it up with a little random jitter added to the points. Note, we are only altering the visualization of the points; the original data is the same.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(evals, <span class="kw">aes</span>(<span class="dt">x=</span>bty_avg, <span class="dt">y=</span>score)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_jitter</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;Beauty Score&quot;</span>, <span class="dt">y=</span><span class="st">&quot;Teaching Score&quot;</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:numxplot2"></span>
<img src="ismaykim_files/figure-html/numxplot2-1.png" alt="Teacher evaluation scores at UT Austin: Jittered" width="\textwidth" />
<p class="caption">
Figure 6.2: Teacher evaluation scores at UT Austin: Jittered
</p>
</div>
</div>
<div id="correlation-coefficient" class="section level3">
<h3><span class="header-section-number">6.2.2</span> Correlation coefficient</h3>
<p>The correlation coefficient between teacher evaluation score and beauty score is high:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cor</span>(evals<span class="op">$</span>score, evals<span class="op">$</span>bty_avg)</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">correlation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.187</td>
</tr>
</tbody>
</table>
</div>
<div id="simple-linear-regression" class="section level3">
<h3><span class="header-section-number">6.2.3</span> Simple linear regression</h3>
<p>Let’s</p>
<ul>
<li>Fit a simple linear regression using the command <code>lm(y ~ x, data)</code> below:</li>
<li>Output the table in tidy data format using the <code>tidy()</code> function from the <code>broom</code> package.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">lm</span>(score<span class="op">~</span>bty_avg, <span class="dt">data=</span>evals) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">tidy</span>()</code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-150">Table 6.2: </span>Regression line estimates</caption>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">3.880</td>
<td align="right">0.076</td>
<td align="right">50.96</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">bty_avg</td>
<td align="right">0.067</td>
<td align="right">0.016</td>
<td align="right">4.09</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p>Let’s plot the regression line with a new layer called <code>+ geom_smooth(method=&quot;lm&quot;)</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(evals, <span class="kw">aes</span>(<span class="dt">x=</span>bty_avg, <span class="dt">y=</span>score)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;Beauty Score&quot;</span>, <span class="dt">y=</span><span class="st">&quot;Teaching Score&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method=</span><span class="st">&quot;lm&quot;</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:numxplot3"></span>
<img src="ismaykim_files/figure-html/numxplot3-1.png" alt="Teacher evaluation scores at UT Austin: With regression line" width="\textwidth" />
<p class="caption">
Figure 6.3: Teacher evaluation scores at UT Austin: With regression line
</p>
</div>
<p>Let’s ignore the grey bars now (which are “error” bars) by adding the argument <code>se=FALSE</code> to <code>geom_smooth</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(evals, <span class="kw">aes</span>(<span class="dt">x=</span>bty_avg, <span class="dt">y=</span>score)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;Beauty Score&quot;</span>, <span class="dt">y=</span><span class="st">&quot;Teaching Score&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method=</span><span class="st">&quot;lm&quot;</span>, <span class="dt">se=</span><span class="ot">FALSE</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:numxplot4"></span>
<img src="ismaykim_files/figure-html/numxplot4-1.png" alt="Teacher evaluation scores at UT Austin: With regression line, no error bars" width="\textwidth" />
<p class="caption">
Figure 6.4: Teacher evaluation scores at UT Austin: With regression line, no error bars
</p>
</div>
</div>
<div id="observed-values-fitted-values-and-residuals" class="section level3">
<h3><span class="header-section-number">6.2.4</span> Observed values, fitted values, and residuals</h3>
<div class="figure" style="text-align: center"><span id="fig:numxplot5"></span>
<img src="ismaykim_files/figure-html/numxplot5-1.png" alt="Teacher evaluation scores at UT Austin: Example of fitted value and residual" width="\textwidth" />
<p class="caption">
Figure 6.5: Teacher evaluation scores at UT Austin: Example of fitted value and residual
</p>
</div>
<ul>
<li>Red point: <em>Observed point</em> <span class="math inline">\((x,y) = (\mbox{beauty score}, \mbox{teaching score}) = (7.333, 4.9)\)</span>. <em>Observed value</em> <span class="math inline">\(y=4.9\)</span></li>
<li>Red square: <em>Fitted point</em> <span class="math inline">\((x,\widehat{y}) = (\mbox{beauty score}, \mbox{fitted teaching score}) = (7.333, 4.369)\)</span>. <em>Fitted value</em> <span class="math inline">\(\widehat{y} = 4.369\)</span>. Why 4.371? From table above: <span class="math inline">\(\widehat{y} = b_0 + b_1 x = 3.880 + 0.067 \times 7.333 = 4.369\)</span></li>
<li>Length of blue arrow: <em>Residual</em> (i.e. error) <span class="math inline">\(y - \widehat{y} = 4.9 - 4.369 = 0.531\)</span></li>
</ul>
<p>Let’s extract point-by-point information now:</p>
<ul>
<li>for all 463 points in our plot, in other words</li>
<li>for all 463 instructors in the study, in other words</li>
<li>for all 463 rows in the <code>evals</code> data frame</li>
</ul>
<p>using the <code>augment()</code> function from the <code>broom</code> package. This function <em>augments</em> the original data by adding new information resulting from the regression. Let’s look at 5 arbitrarily chosen rows. (Note that the first row in the table corresponds to the red points and blue arrow in Figure <a href="6-regression.html#fig:numxplot5">6.5</a>):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">point_by_point_info &lt;-<span class="st"> </span><span class="kw">lm</span>(score<span class="op">~</span>bty_avg, <span class="dt">data=</span>evals) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">augment</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">select</span>(score, bty_avg, .fitted, .resid)</code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-152">Table 6.3: </span>Point-by-point information (5 of 463 rows)</caption>
<thead>
<tr class="header">
<th align="right">score</th>
<th align="right">bty_avg</th>
<th align="right">.fitted</th>
<th align="right">.resid</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">4.9</td>
<td align="right">7.333</td>
<td align="right">4.369</td>
<td align="right">0.531</td>
</tr>
<tr class="even">
<td align="right">3.6</td>
<td align="right">6.667</td>
<td align="right">4.325</td>
<td align="right">-0.725</td>
</tr>
<tr class="odd">
<td align="right">4.9</td>
<td align="right">3.500</td>
<td align="right">4.114</td>
<td align="right">0.786</td>
</tr>
<tr class="even">
<td align="right">3.3</td>
<td align="right">2.333</td>
<td align="right">4.036</td>
<td align="right">-0.736</td>
</tr>
<tr class="odd">
<td align="right">4.4</td>
<td align="right">4.667</td>
<td align="right">4.191</td>
<td align="right">0.209</td>
</tr>
</tbody>
</table>
<p>The periods in the variable names indicated that they are new information that was added to the original dataset. In particular</p>
<ul>
<li><strong>.fitted</strong>: the fitted value <span class="math inline">\(\widehat{y}\)</span> corresponding to an observed point <span class="math inline">\((x,y)\)</span>. One example is the red square in Figure <a href="6-regression.html#fig:numxplot5">6.5</a></li>
<li><strong>.resid</strong>: the residual <span class="math inline">\(y - \widehat{y}\)</span>. One example is the length of the blue arrow in Figure <a href="6-regression.html#fig:numxplot5">6.5</a>.</li>
</ul>
</div>
<div id="residual_analysis" class="section level3">
<h3><span class="header-section-number">6.2.5</span> Residual analysis</h3>
<p>Recall the residuals can be thought of as “lack-of-fit”, or “left-overs”, or “errors”. Ideally, we want there to be <em>no systematic pattern</em> to the residuals. What does this mean?</p>
<ol style="list-style-type: decimal">
<li>The residuals should be on average 0.</li>
<li>The spread of the residuals should be consistent.</li>
<li>The value of the residuals should not depend on the value of x</li>
</ol>
<p>Let’s look at the residuals two ways. First, recall in Figure <a href="6-regression.html#fig:numxplot5">6.5</a> above we plotted:</p>
<ul>
<li>On the y-axis: <span class="math inline">\(y\)</span> teaching score</li>
<li>On the x-axis: <span class="math inline">\(x\)</span> beauty score</li>
</ul>
<p>Instead, in Figure <a href="6-regression.html#fig:numxplot6">6.6</a> below let’s plot</p>
<ul>
<li>On the y-axis: <span class="math inline">\(y-\widehat{y}\)</span> residual instead</li>
<li>On the x-axis: <span class="math inline">\(x\)</span> beauty score (same as before)</li>
</ul>
<div class="figure" style="text-align: center"><span id="fig:numxplot6"></span>
<img src="ismaykim_files/figure-html/numxplot6-1.png" alt="Plot of residuals over beauty score" width="\textwidth" />
<p class="caption">
Figure 6.6: Plot of residuals over beauty score
</p>
</div>
<p>You can think of Figure <a href="6-regression.html#fig:numxplot6">6.6</a> as Figure <a href="6-regression.html#fig:numxplot5">6.5</a>, but with the blue line flattened out. Does it seem like there is <em>no systematic pattern</em> to the residuals?</p>
<p>Here are some hypothetical examples where there is a systematic pattern to the residuals:</p>
<div class="figure" style="text-align: center"><span id="fig:numxplot7"></span>
<img src="ismaykim_files/figure-html/numxplot7-1.png" alt="Examples of less than ideal residual patterns" width="\textwidth" />
<p class="caption">
Figure 6.7: Examples of less than ideal residual patterns
</p>
</div>
<p>The second way to look at the residuals is using a histogram:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(point_by_point_info, <span class="kw">aes</span>(<span class="dt">x=</span>.resid)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="fl">0.25</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;Residual&quot;</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:numxplot8"></span>
<img src="ismaykim_files/figure-html/numxplot8-1.png" alt="Histogram of residuals" width="\textwidth" />
<p class="caption">
Figure 6.8: Histogram of residuals
</p>
</div>
<p>This histogram seems to indicate that we have more positive residuals than negative. Since Residual = <span class="math inline">\(y-\widehat{y} &gt; 0\)</span> when <span class="math inline">\(y &gt; \widehat{y}\)</span>, it seems our fitted professor score from the regression model have a slight tendency of being small than the actually observed score.</p>
<p>This histogram has a slight <em>left-skew</em> in that there is a long tail on the left. Another way to say this is this data exhibit a <em>negative skew</em>. Here are examples of an ideal and less than ideal patterns of residuals.</p>
<div class="figure" style="text-align: center"><span id="fig:numxplot9"></span>
<img src="ismaykim_files/figure-html/numxplot9-1.png" alt="Examples of ideal and less than ideal residual patterns" width="\textwidth" />
<p class="caption">
Figure 6.9: Examples of ideal and less than ideal residual patterns
</p>
</div>
<p>In fact, we’ll see later on that we would like the residuals to be <em>normally distributed</em> with mean 0. In other words, be bell-shaped and centered at 0!</p>
</div>
<div id="best-fitting-lines" class="section level3">
<h3><span class="header-section-number">6.2.6</span> Best fitting lines</h3>
<p>Regression lines are also known as “best fitting lines”. But what do we mean by best? Let’s unpack the criteria that is used by regression to determine best. Recall the plot in Figure <a href="6-regression.html#fig:numxplot5">6.5</a>) where for a professor with a beauty average score of <span class="math inline">\(x=7.333\)</span></p>
<ul>
<li>The observed value <span class="math inline">\(y=4.9\)</span> was marked with a red circle</li>
<li>The fitted value <span class="math inline">\(\widehat{y} = 4.369\)</span> on the regression line was marked with a red square</li>
<li>The residual <span class="math inline">\(y-\widehat{y} = 4.9-4.369 = 0.531\)</span> was the length of the blue arrow.</li>
</ul>
<p>Let’s do this for another arbitrarily chosen professor whose beauty score was <span class="math inline">\(x=2.333\)</span>. The residual in this case is <span class="math inline">\(2.7 - 4.036 = -1.336\)</span>.</p>
<p><img src="ismaykim_files/figure-html/unnamed-chunk-153-1.png" width="\textwidth" style="display: block; margin: auto;" /></p>
<p>Let’s do this for another arbitrarily chosen professor whose beauty score was <span class="math inline">\(x=3.667\)</span>. The residual in this case is <span class="math inline">\(4.4 - 4.125 = 0.2753\)</span>.</p>
<p><img src="ismaykim_files/figure-html/unnamed-chunk-154-1.png" width="\textwidth" style="display: block; margin: auto;" /></p>
<p>Let’s do this for another arbitrarily chosen professor whose beauty score was <span class="math inline">\(x=6\)</span>. The residual in this case is <span class="math inline">\(3.8 - 4.28 = -0.4802\)</span>.</p>
<p><img src="ismaykim_files/figure-html/unnamed-chunk-155-1.png" width="\textwidth" style="display: block; margin: auto;" /></p>
<p>Now let’s say we repeated this process for all 463 professors in our dataset. Regression <em>minimizes the sum of all 463 arrow lengths squared.</em> In other words, it minimizes the sum of the squared residuals:</p>
<p><span class="math display">\[
\sum_{i=1}^{n}(y_i - \widehat{y}_i)^2
\]</span></p>
<p>We square the arrow lengths so that positive and negative deviations of the same amount are treated equally. That’s why alternative names for the simple linear regression line are the <strong>least-squares line</strong> and the <strong>best fitting line</strong>. It can be proven via calculus and linear algebra that this line uniquely minimizes the sum of the squared arrow lengths.</p>
<p>For the regression line in the plot, the sum of the squared residuals is 131.868.</p>
</div>
</div>
<div id="one-categorical-x-worldwide-life-expectancy" class="section level2">
<h2><span class="header-section-number">6.3</span> One categorical x: Worldwide life expectancy</h2>
<div id="exploratory-data-analysis-1" class="section level3">
<h3><span class="header-section-number">6.3.1</span> Exploratory data analysis</h3>
<p>Let’s load the country-by-country life expectancy <code>gapminder2007</code> data frame that we created in the “Datasets” Section <a href="6-regression.html#datalifeexp">6.1.2</a>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lifeExp_by_continent &lt;-<span class="st"> </span>gapminder2007 <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(continent) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarize</span>(<span class="dt">median =</span> <span class="kw">median</span>(lifeExp))</code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-157">Table 6.4: </span>Life expectancy by continent</caption>
<thead>
<tr class="header">
<th align="left">continent</th>
<th align="right">median</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Africa</td>
<td align="right">52.93</td>
</tr>
<tr class="even">
<td align="left">Americas</td>
<td align="right">72.90</td>
</tr>
<tr class="odd">
<td align="left">Asia</td>
<td align="right">72.40</td>
</tr>
<tr class="even">
<td align="left">Europe</td>
<td align="right">78.61</td>
</tr>
<tr class="odd">
<td align="left">Oceania</td>
<td align="right">80.72</td>
</tr>
</tbody>
</table>
<p>The median life expectancy in Africa in was 52.93. Let’s look at a boxplot of life expectancy and mark the median for Africa in red.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(gapminder2007, <span class="kw">aes</span>(<span class="dt">x=</span>continent, <span class="dt">y=</span>lifeExp)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="fl">52.93</span>, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>, <span class="dt">size=</span><span class="dv">1</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Continent&quot;</span>, <span class="dt">y=</span><span class="st">&quot;Life expectancy (years)&quot;</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:catxplot1"></span>
<img src="ismaykim_files/figure-html/catxplot1-1.png" alt="Life expectancy in 2007" width="\textwidth" />
<p class="caption">
Figure 6.10: Life expectancy in 2007
</p>
</div>
<p>Let’s look number of years difference relative to Africa’s median.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(gapminder2007, <span class="kw">aes</span>(<span class="dt">x=</span>continent, <span class="dt">y=</span>lifeExp<span class="op">-</span><span class="fl">52.93</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>, <span class="dt">size=</span><span class="dv">1</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;Continent&quot;</span>, <span class="dt">y=</span><span class="st">&quot;Difference in life expectancy (years)&quot;</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:catxplot2"></span>
<img src="ismaykim_files/figure-html/catxplot2-1.png" alt="Difference in life expectancy relative to African median of 52.93 years" width="\textwidth" />
<p class="caption">
Figure 6.11: Difference in life expectancy relative to African median of 52.93 years
</p>
</div>
</div>
<div id="simple-linear-regression-1" class="section level3">
<h3><span class="header-section-number">6.3.2</span> Simple linear regression</h3>
<p>Note that while the boxplots in Figure <a href="6-regression.html#fig:catxplot2">6.11</a>) involved medians, regression involves means. Using the <code>gapminder2007</code> data frame again, let’s compute <em>mean</em> life expectancy instead of median.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gapminder2007 <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(continent) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarize</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(lifeExp))</code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-159">Table 6.5: </span>Continent means</caption>
<thead>
<tr class="header">
<th align="left">continent</th>
<th align="right">mean</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Africa</td>
<td align="right">54.81</td>
</tr>
<tr class="even">
<td align="left">Americas</td>
<td align="right">73.61</td>
</tr>
<tr class="odd">
<td align="left">Asia</td>
<td align="right">70.73</td>
</tr>
<tr class="even">
<td align="left">Europe</td>
<td align="right">77.65</td>
</tr>
<tr class="odd">
<td align="left">Oceania</td>
<td align="right">80.72</td>
</tr>
</tbody>
</table>
<p>Let’s now compute the <em>regression table</em>. Recall:</p>
<ul>
<li><code>lm(lifeExp ~ continent, data=gapminder2007)</code> is a regression where
<ul>
<li><span class="math inline">\(y\)</span> is the numerical outcome variable life expectancy</li>
<li><span class="math inline">\(x\)</span> is the categorical explanatory/predictor variable continent</li>
</ul></li>
<li>We then pipe this into <code>tidy()</code> from the <code>broom</code> package. All this does is output the regression table in a clean format; “tidy data” format as seen in Chapter <a href="4-tidy.html#tidy">4</a> in fact!</li>
<li>You can think of the following two lines of code as a <code>generate_regression_table()</code> function:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">lm</span>(lifeExp <span class="op">~</span><span class="st"> </span>continent, <span class="dt">data=</span>gapminder2007) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">tidy</span>()</code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-161">Table 6.6: </span>Regression table</caption>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">54.81</td>
<td align="right">1.03</td>
<td align="right">53.45</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">continentAmericas</td>
<td align="right">18.80</td>
<td align="right">1.80</td>
<td align="right">10.45</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">continentAsia</td>
<td align="right">15.92</td>
<td align="right">1.65</td>
<td align="right">9.67</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">continentEurope</td>
<td align="right">22.84</td>
<td align="right">1.70</td>
<td align="right">13.47</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">continentOceania</td>
<td align="right">25.91</td>
<td align="right">5.33</td>
<td align="right">4.86</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p>What are these values? Recall:</p>
<ul>
<li>Africa is treated as the “baseline for comparison”.
<ul>
<li>The intercept of 54.81 corresponds to the mean life expectancy of Africa.</li>
<li>It was chosen for no other reason than it is first alphabetically. You can manually specify which continent to use as baseline, but we leave that to a more advanced course.</li>
</ul></li>
<li>continentAmericas was created by the regression.
<ul>
<li>It is the additional mean life expectancy of the Americas <em>above and beyond the baseline of comparison which is Africa</em>. Note that 18.80 = 73.61 - 54.81, the difference in mean life expectancies of the Americas and Africa from the table of continent means above.</li>
</ul></li>
<li>Same goes for Asia, Europe, and Oceania</li>
<li>What are std.error, statistic, and p.value? We’ll see this later in the course after we’ve seen statistical inference, but here’s a preview:
<ul>
<li>std.error is the standard error: it quantifies the uncertainy</li>
<li>statistic and p.value: these inform us on the <em>statistical significance</em></li>
</ul></li>
</ul>
<p>To really bring home what the values in the regression table are, let’s subtract the mean life expectancy for Africa of 54.81 from each of the 5 mean life expectancies we computed in the table above and add a new column.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gapminder2007 <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(continent) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarize</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(lifeExp)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">compare_to_africa =</span> <span class="kw">round</span>(mean <span class="op">-</span><span class="st"> </span><span class="fl">54.81</span>,<span class="dv">2</span>))</code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-163">Table 6.7: </span>Continent means and comparison of means relative to baseline</caption>
<thead>
<tr class="header">
<th align="left">continent</th>
<th align="right">mean</th>
<th align="right">compared_to_africa</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Africa</td>
<td align="right">54.81</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">Americas</td>
<td align="right">73.61</td>
<td align="right">18.80</td>
</tr>
<tr class="odd">
<td align="left">Asia</td>
<td align="right">70.73</td>
<td align="right">15.92</td>
</tr>
<tr class="even">
<td align="left">Europe</td>
<td align="right">77.65</td>
<td align="right">22.84</td>
</tr>
<tr class="odd">
<td align="left">Oceania</td>
<td align="right">80.72</td>
<td align="right">25.91</td>
</tr>
</tbody>
</table>
</div>
<div id="observed-values-fitted-values-and-residuals-1" class="section level3">
<h3><span class="header-section-number">6.3.3</span> Observed values, fitted values, and residuals</h3>
<p>Let’s extract point-by-point information now:</p>
<ul>
<li>for all 142 points in the five boxplots in Figure <a href="6-regression.html#fig:catxplot2">6.11</a>)</li>
<li>for all 142 countries in our dataset</li>
<li>for all 142 rows in the <code>gapminder2007</code> data frame</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">point_by_point_info &lt;-<span class="st"> </span><span class="kw">lm</span>(lifeExp <span class="op">~</span><span class="st"> </span>continent, <span class="dt">data=</span>gapminder2007) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">augment</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">select</span>(lifeExp, continent, .fitted, .resid)</code></pre></div>
<p>Note:</p>
<ul>
<li><code>lm(lifeExp ~ continent, data=gapminder2007)</code> is the regression from earlier</li>
<li>We then pipe this into <code>augment()</code> from the <code>broom</code> package. All this does is output point-by-point information in a clean format; “tidy data” format as seen in Chapter <a href="4-tidy.html#tidy">4</a> in fact!</li>
<li>We then only select the <code>lifeExp</code>, <code>continent</code>, <code>.fitted</code>, and <code>.resid</code> columns. We don’t need the rest, so let’s keep our output clean.</li>
</ul>
<p>Let’s look at a random sample of 5 of these 142 rows:</p>
<table>
<caption><span id="tab:unnamed-chunk-165">Table 6.8: </span>Point-by-point information (5 of 142 rows)</caption>
<thead>
<tr class="header">
<th></th>
<th align="right">lifeExp</th>
<th align="left">continent</th>
<th align="right">.fitted</th>
<th align="right">.resid</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>89</td>
<td align="right">52.91</td>
<td align="left">Africa</td>
<td align="right">54.81</td>
<td align="right">-1.900</td>
</tr>
<tr class="even">
<td>104</td>
<td align="right">78.10</td>
<td align="left">Europe</td>
<td align="right">77.65</td>
<td align="right">0.449</td>
</tr>
<tr class="odd">
<td>61</td>
<td align="right">70.96</td>
<td align="left">Asia</td>
<td align="right">70.73</td>
<td align="right">0.236</td>
</tr>
<tr class="even">
<td>15</td>
<td align="right">72.39</td>
<td align="left">Americas</td>
<td align="right">73.61</td>
<td align="right">-1.218</td>
</tr>
<tr class="odd">
<td>65</td>
<td align="right">80.55</td>
<td align="left">Europe</td>
<td align="right">77.65</td>
<td align="right">2.897</td>
</tr>
</tbody>
</table>
</div>
<div id="residual-analysis" class="section level3">
<h3><span class="header-section-number">6.3.4</span> Residual analysis</h3>
<p>Recall our discussion on residuals from Section @ref(residual_analysis) where there were two ways to visualize the residuals to see if there is a <em>systematic pattern</em> to them:</p>
<ol style="list-style-type: decimal">
<li>A plot with residuals on the y-axis and the predictor (in this case continent) on the x-axis</li>
<li>A histogram of all residuals</li>
</ol>
<p>First, let’s plot the residuals vs continent using <code>geom_jitter()</code> again because of overplotting issues. Note here we control the amount of jitter horizontally by setting the <code>width</code> argument. Doesn’t seem to bad!</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(point_by_point_info, <span class="kw">aes</span>(<span class="dt">x=</span>continent, <span class="dt">y=</span>.resid)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">width=</span><span class="fl">0.1</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;Continent&quot;</span>, <span class="dt">y=</span><span class="st">&quot;Residual&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept=</span><span class="dv">0</span>, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">size =</span><span class="dv">1</span>) </code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:catxplot7"></span>
<img src="ismaykim_files/figure-html/catxplot7-1.png" alt="Plot of residuals over continent" width="\textwidth" />
<p class="caption">
Figure 6.12: Plot of residuals over continent
</p>
</div>
<p>However, there is one clear outlier in Asia. It has the smallest residual, hence also has the smallest life expectancy in Asia. Let’s see who the 5 countries with the shortest life expectancy are:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gapminder2007 <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(continent <span class="op">==</span><span class="st"> &quot;Asia&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">select</span>(country, lifeExp) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(lifeExp)</code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-167">Table 6.9: </span>Countries in Asia with shortest life expectancy</caption>
<thead>
<tr class="header">
<th align="left">country</th>
<th align="right">lifeExp</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Afghanistan</td>
<td align="right">43.83</td>
</tr>
<tr class="even">
<td align="left">Iraq</td>
<td align="right">59.55</td>
</tr>
<tr class="odd">
<td align="left">Cambodia</td>
<td align="right">59.72</td>
</tr>
<tr class="even">
<td align="left">Myanmar</td>
<td align="right">62.07</td>
</tr>
<tr class="odd">
<td align="left">Yemen, Rep.</td>
<td align="right">62.70</td>
</tr>
</tbody>
</table>
<p>Second, let’s look at a histogram of all 142 residuals:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(point_by_point_info, <span class="kw">aes</span>(<span class="dt">x=</span>.resid)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">5</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;Residual&quot;</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:catxplot8"></span>
<img src="ismaykim_files/figure-html/catxplot8-1.png" alt="Histogram of residuals" width="\textwidth" />
<p class="caption">
Figure 6.13: Histogram of residuals
</p>
</div>
<p>Looks pretty good!</p>
</div>
</div>
<div id="two-numerical-x-credit-card-balance" class="section level2">
<h2><span class="header-section-number">6.4</span> Two numerical x: Credit card balance</h2>
<p>We now move from <em>simple linear regression</em>, which involves a single explanatory/predictor variable, to <em>multiple regression</em>, which involves more than one explanatory/predictor variable.</p>
<div id="exploratory-data-analysis-2" class="section level3">
<h3><span class="header-section-number">6.4.1</span> Exploratory data analysis</h3>
<p>Let’s load the Credit card balance <code>Credit</code> data frame that we created in the “Datasets” Section <a href="6-regression.html#datacreditcard">6.1.3</a>.</p>
<p>Now that we have two numerical predictors, an ideal way to visualize this data is with a 3D scatterplot. Unfortunately this is beyond the scope of this book, so let’s do the next best thing and look at two separate scatterplots of the outcome variable <span class="math inline">\(y\)</span> credit card balance in dollars with</p>
<ol style="list-style-type: decimal">
<li>Explanatory/predictor variable <span class="math inline">\(x\)</span> being credit limit in dollars</li>
<li>Explanatory/predictor variable <span class="math inline">\(x\)</span> being income in $1000 units</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(Credit, <span class="kw">aes</span>(<span class="dt">x=</span>Limit, <span class="dt">y=</span>Balance)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;Credit limit (in $)&quot;</span>, <span class="dt">y=</span><span class="st">&quot;Credit card balance (in $)&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method=</span><span class="st">&quot;lm&quot;</span>, <span class="dt">se=</span><span class="ot">FALSE</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:2numxplot1"></span>
<img src="ismaykim_files/figure-html/2numxplot1-1.png" alt="Relationship between credit card balance and credit limit" width="\textwidth" />
<p class="caption">
Figure 6.14: Relationship between credit card balance and credit limit
</p>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(Credit, <span class="kw">aes</span>(<span class="dt">x=</span>Income, <span class="dt">y=</span>Balance)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;Income (in $1000)&quot;</span>, <span class="dt">y=</span><span class="st">&quot;Credit card balance (in $)&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method=</span><span class="st">&quot;lm&quot;</span>, <span class="dt">se=</span><span class="ot">FALSE</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:2numxplot2"></span>
<img src="ismaykim_files/figure-html/2numxplot2-1.png" alt="Relationship between credit card balance and income" width="\textwidth" />
<p class="caption">
Figure 6.15: Relationship between credit card balance and income
</p>
</div>
<p>In both cases, there seems to be a positive relationship. Let’s look at the correlation coefficient in both cases.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cor</span>(Credit<span class="op">$</span>Limit, Credit<span class="op">$</span>Balance)</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">correlation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.862</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cor</span>(Credit<span class="op">$</span>Income, Credit<span class="op">$</span>Balance)</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">correlation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.464</td>
</tr>
</tbody>
</table>
<p>In both cases, the correlation coefficient indicates a strong linear relationship, in particular between credit limit and credit card balance! Makes sense! Note however there were a few individuals who had balances of 0!</p>
<p>What if in instead we looked the correlation coefficient between income and credit card balance, where income was in dollars and not thousands of dollars? i.e. we multiply Income by 1000?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cor</span>(Credit<span class="op">$</span>Income <span class="op">*</span><span class="st"> </span><span class="dv">1000</span>, Credit<span class="op">$</span>Balance)</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">correlation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.464</td>
</tr>
</tbody>
</table>
<p>We see it is the same! We say that correlation coefficient is invariant to linear transformations! In other words</p>
<ul>
<li>The correlation between <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> will be the same as</li>
<li>The correlation between <span class="math inline">\(a\times x + b\)</span> and <span class="math inline">\(y\)</span> where <span class="math inline">\(a, b\)</span> are numerical values (real numbers in mathematical terms)</li>
</ul>
</div>
<div id="multiple-regression" class="section level3">
<h3><span class="header-section-number">6.4.2</span> Multiple regression</h3>
<p>Let’s now compute the <em>regression table</em></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">lm</span>(Balance <span class="op">~</span><span class="st"> </span>Limit <span class="op">+</span><span class="st"> </span>Income, <span class="dt">data=</span>Credit) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">tidy</span>()</code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-175">Table 6.10: </span>Regression table</caption>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">-385.18</td>
<td align="right">19.46</td>
<td align="right">-19.79</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">Limit</td>
<td align="right">0.26</td>
<td align="right">0.01</td>
<td align="right">44.95</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">Income</td>
<td align="right">-7.66</td>
<td align="right">0.39</td>
<td align="right">-19.90</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p>Whereas in simple linear regression with a single numerical predictor, for multiple linear regression with two numerical predictors, the regression line is now a <em>regression plane</em>. In other words, a flat surface! See the interactive 3D scatterplot with a regression plane added <a href="https://rudeboybert.github.io/STAT135/index.html#36_multiple_regression">here</a>.</p>
<p>How do we interpret the three values that define the plane?</p>
<ul>
<li>Intercept: -$385.18. In this case, the intercept doesn’t have a practical interpretation as no one can have a credit card balance of less than $0. It is used merely to situation the plane.</li>
<li>Limit: $0.26. Now that we have multiple variables to consider, we have to add a caveat to our interpretation: <em>all other things being equal, for every increase in one dollar in credit limit, there is an associated increase of on average 26 cents in credit card balance</em>. Note:
<ul>
<li>Again, we are not making any causal statements, only statements relating to the association between credit limit and balance</li>
<li>The <em>all other things being equal</em> related to the other explanatory/predictor variables, in this case only one: Income. This is equivalent to saying “holding income constant, we observed an associated increase of $0.26 in credit card balance for every dollar increase in credit limit”</li>
</ul></li>
<li>Income: -$7.66. Negative? Say what? Didn’t we see in Figure <a href="6-regression.html#fig:2numxplot2">6.15</a>) that the relationship was positive and that the correlation between Income and credit card balance was positive?</li>
</ul>
<p>Here is a histogram of all <code>nrow(Credit)</code> values of <code>Limit</code> where the vertical red lines cut up the data into quartiles.</p>
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<div class="figure" style="text-align: center"><span id="fig:2numxplot3"></span>
<img src="ismaykim_files/figure-html/2numxplot3-1.png" alt="Histogram of credit limits and quartiles" width="\textwidth" />
<p class="caption">
Figure 6.16: Histogram of credit limits and quartiles
</p>
</div>
<p>In other words,</p>
<ol style="list-style-type: decimal">
<li>25% of people had credit limits between $0 and $3088. Let’s call this group “low” credit limit bracket.</li>
<li>25% of people had credit limits between $3088 and $4622. Let’s call this group “medium-low” credit limit bracket.</li>
<li>25% of people had credit limits between $4622 and $5873. Let’s call this group “medium-high” credit limit bracket.</li>
<li>25% of peopel had credit limits over $5873. Let’s call this group “high” credit limit bracket.</li>
</ol>
<div class="figure" style="text-align: center"><span id="fig:2numxplot4"></span>
<img src="ismaykim_files/figure-html/2numxplot4-1.png" alt="Relationship between credit card balance and income for different credit limit brackets" width="\textwidth" />
<p class="caption">
Figure 6.17: Relationship between credit card balance and income for different credit limit brackets
</p>
</div>
<p>Figure <a href="6-regression.html#fig:2numxplot4">6.17</a>) is actually the same as Figure <a href="6-regression.html#fig:2numxplot2">6.15</a>), but now with colors distinguishing the credit limit brackets. We now see that for the</p>
<ol style="list-style-type: decimal">
<li>low</li>
<li>medium-low</li>
<li>medium-high</li>
</ol>
<p>income bracket groups, the strong positive relationship between credit card balance and income disappears! Only for the high bracket does the relationship stay somewhat positive. In this example credit limit is a <em>confounding variable</em> for credit card balance and income.</p>
<p>Alternatively, we could also have used facets, where each facet has roughly 25% of people based on the credit limit bracket. However, IMO the above plot is easier to read.</p>
<div class="figure" style="text-align: center"><span id="fig:2numxplot5"></span>
<img src="ismaykim_files/figure-html/2numxplot5-1.png" alt="Relationship between credit card balance and income for different credit limit brackets" width="\textwidth" />
<p class="caption">
Figure 6.18: Relationship between credit card balance and income for different credit limit brackets
</p>
</div>
</div>
</div>
<div id="one-numerical-x-and-one-categorical-x-professor-evaluations" class="section level2">
<h2><span class="header-section-number">6.5</span> One numerical x and one categorical x: Professor evaluations</h2>
<p>Let’s revisit the professor evaluation data introduced in Section <a href="6-regression.html#profevals">6.1.1</a>. In Section @ref(#onenumerical) we studied the relationship between</p>
<ul>
<li><span class="math inline">\(y\)</span>: outcome variable of teacher evaluation score</li>
<li><span class="math inline">\(x\)</span>: numerical explanatory variable of beauty score</li>
</ul>
<p>Now let’s say we want to also consider age instead of beauty score and a categorical explanatory/predictor variable: the binary gender of the professor. Our modeling situation now becomes</p>
<ul>
<li>y: outcome variable of teacher evaluation score</li>
<li>predictor variables
<ul>
<li><span class="math inline">\(x_1\)</span>: numerical explanatory/predictor variable of age</li>
<li><span class="math inline">\(x_2\)</span>: categorical explanatory/predictor variable of gender</li>
</ul></li>
</ul>
<div id="exploratory-data-analysis-3" class="section level3">
<h3><span class="header-section-number">6.5.1</span> Exploratory data analysis</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(evals, <span class="kw">aes</span>(<span class="dt">x=</span>age, <span class="dt">y=</span>score, <span class="dt">col=</span>gender)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_jitter</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;Age&quot;</span>, <span class="dt">y=</span><span class="st">&quot;Teaching Score&quot;</span>, <span class="dt">color=</span><span class="st">&quot;Gender&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method=</span><span class="st">&quot;lm&quot;</span>, <span class="dt">se=</span><span class="ot">FALSE</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:numxcatxplot1"></span>
<img src="ismaykim_files/figure-html/numxcatxplot1-1.png" alt="Teacher evaluation scores at UT Austin by gender: Jittered" width="\textwidth" />
<p class="caption">
Figure 6.19: Teacher evaluation scores at UT Austin by gender: Jittered
</p>
</div>
<p>We notice some interesting trends:</p>
<ol style="list-style-type: decimal">
<li>There are almost no women faculty over the age of 60.</li>
<li>Fitting separate regression lines for men and women, we see they have different slopes. We see that the associated effect of increasing age seems to be much harsher for women than men. In other words, they have different slopes.</li>
</ol>
</div>
<div id="multiple-regression-1" class="section level3">
<h3><span class="header-section-number">6.5.2</span> Multiple regression</h3>
<p>Let’s now compute the <em>regression table</em></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">lm</span>(score <span class="op">~</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>gender, <span class="dt">data=</span>evals) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">tidy</span>()</code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-177">Table 6.11: </span>Regression table</caption>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">4.4841</td>
<td align="right">0.1253</td>
<td align="right">35.792</td>
<td align="right">0.0000</td>
</tr>
<tr class="even">
<td align="left">age</td>
<td align="right">-0.0087</td>
<td align="right">0.0026</td>
<td align="right">-3.280</td>
<td align="right">0.0011</td>
</tr>
<tr class="odd">
<td align="left">gendermale</td>
<td align="right">0.1906</td>
<td align="right">0.0525</td>
<td align="right">3.632</td>
<td align="right">0.0003</td>
</tr>
</tbody>
</table>
<p>The modeling equation for this is:</p>
<p><span class="math display">\[
\begin{align}
\widehat{y} &amp;= b_0 + b_1 x_1 + b_2 x_2 \\
\widehat{score} &amp;= b_0 + b_{age} age + b_{male} \mathbb{1}[\mbox{is male}] \\
\end{align}
\]</span></p>
<p>What this looks like is in Figure <a href="6-regression.html#fig:numxcatxplot2">6.20</a>) below.</p>
<div class="figure" style="text-align: center"><span id="fig:numxcatxplot2"></span>
<img src="ismaykim_files/figure-html/numxcatxplot2-1.png" alt="Teacher evaluation scores at UT Austin by gender: same slope" width="\textwidth" />
<p class="caption">
Figure 6.20: Teacher evaluation scores at UT Austin by gender: same slope
</p>
</div>
<p>We see that:</p>
<ul>
<li>Females are treated as the baseline for comparison for no other reason than “female” is alphabetically earlier than “male”. The <span class="math inline">\(b_{male} = 0.1906\)</span> is the vertical “bump” that men get in their teaching evaluation scores. Or more precisely, it is the average difference in teaching score that men get <em>relative to the baseline of women</em></li>
<li>Accordingly, the intercepts are (which in this case make no sense since no professor can have age 0):
<ul>
<li>for women: <span class="math inline">\(b_0\)</span> = 4.484</li>
<li>for men: <span class="math inline">\(b_0 + b_{male}\)</span> = 4.484 + 0.191 = 4.675</li>
</ul></li>
<li>Both men and women have the same slope. In other words, <em>in this model</em> the associated effect of age is the same for men and women: all other things being equal, for every increase in 1 in age, there is on average an associated decrease of <span class="math inline">\(b_{age}\)</span> = -0.0086 in teaching score</li>
</ul>
<p><strong>Hold up</strong>: Figure <a href="6-regression.html#fig:numxcatxplot2">6.20</a>) is different than Figure <a href="6-regression.html#fig:numxcatxplot1">6.19</a>)! What is going on? What we have in the original plot is an <em>interaction effect</em> between age and gender!</p>
</div>
<div id="interaction-effects" class="section level3">
<h3><span class="header-section-number">6.5.3</span> Interaction effects</h3>
<p>We say a model has an interaction effect if the associated effect of one variable <em>depends on the value of another variable</em>.</p>
<p>Let’s now compute the <em>regression table</em></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">lm</span>(score <span class="op">~</span><span class="st"> </span>age <span class="op">*</span><span class="st"> </span>gender, <span class="dt">data=</span>evals) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">tidy</span>()</code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-179">Table 6.12: </span>Regression table</caption>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">4.8830</td>
<td align="right">0.2052</td>
<td align="right">23.795</td>
<td align="right">0.0000</td>
</tr>
<tr class="even">
<td align="left">age</td>
<td align="right">-0.0175</td>
<td align="right">0.0045</td>
<td align="right">-3.918</td>
<td align="right">0.0001</td>
</tr>
<tr class="odd">
<td align="left">gendermale</td>
<td align="right">-0.4460</td>
<td align="right">0.2654</td>
<td align="right">-1.681</td>
<td align="right">0.0935</td>
</tr>
<tr class="even">
<td align="left">age:gendermale</td>
<td align="right">0.0135</td>
<td align="right">0.0055</td>
<td align="right">2.446</td>
<td align="right">0.0148</td>
</tr>
</tbody>
</table>
<p>The model formula is</p>
<p><span class="math display">\[
\begin{align}
\widehat{y} &amp;= b_0 + b_1 x_1 + b_2 x_2 + b_3 x_1x_2\\
\widehat{score} &amp;= b_0 + b_{age} age + b_{male} \mathbb{1}[\mbox{is male}] + b_{age,male}age\mathbb{1}[\mbox{is male}] \\
\end{align}
\]</span></p>
</div>
</div>
<div id="two-categorical-x-biopics" class="section level2">
<h2><span class="header-section-number">6.6</span> Two categorical x: Biopics</h2>
<p>Before we conduct an exploratory data analysis of the <code>biopics</code> data, let’s first have a discussion <span class="math inline">\(\log\)</span>-transformations.</p>
<div id="log-transformations" class="section level3">
<h3><span class="header-section-number">6.6.1</span> log-transformations</h3>
<p>Let’s consider a histogram of the box office revenues for the <code>biopics</code> dataset</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(biopics, <span class="kw">aes</span>(<span class="dt">x=</span>box_office)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_histogram</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;Box office revenue&quot;</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:logtransform1"></span>
<img src="ismaykim_files/figure-html/logtransform1-1.png" alt="Histogram of box office revenue" width="\textwidth" />
<p class="caption">
Figure 6.21: Histogram of box office revenue
</p>
</div>
<p>In Figure <a href="6-regression.html#fig:logtransform1">6.21</a>), we see there is a right-skew to both the x-values. This is because there are a few Hollywood blockbusters being compared with many (likely) smaller-scale independent films. Let’s look at the top 5 and bottom 5 grossing movies in this dataset:</p>
<table>
<caption><span id="tab:unnamed-chunk-180">Table 6.13: </span>Top 5 grossing movies in data</caption>
<thead>
<tr class="header">
<th align="left">title</th>
<th align="right">box_office</th>
<th align="left">person_of_color</th>
<th align="left">subject_sex</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">American Sniper</td>
<td align="right">350000000</td>
<td align="left">FALSE</td>
<td align="left">Male</td>
</tr>
<tr class="even">
<td align="left">The Blind Side</td>
<td align="right">256000000</td>
<td align="left">TRUE</td>
<td align="left">Male</td>
</tr>
<tr class="odd">
<td align="left">Lincoln</td>
<td align="right">182000000</td>
<td align="left">FALSE</td>
<td align="left">Male</td>
</tr>
<tr class="even">
<td align="left">A Beautiful Mind</td>
<td align="right">171000000</td>
<td align="left">FALSE</td>
<td align="left">Male</td>
</tr>
<tr class="odd">
<td align="left">Catch Me If You Can</td>
<td align="right">164000000</td>
<td align="left">FALSE</td>
<td align="left">Male</td>
</tr>
</tbody>
</table>
<table>
<caption><span id="tab:unnamed-chunk-181">Table 6.14: </span>Bottom 5 grossing movies in data</caption>
<thead>
<tr class="header">
<th align="left">title</th>
<th align="right">box_office</th>
<th align="left">person_of_color</th>
<th align="left">subject_sex</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Caravaggio</td>
<td align="right">3150</td>
<td align="left">FALSE</td>
<td align="left">Male</td>
</tr>
<tr class="even">
<td align="left">Set Fire to the Stars</td>
<td align="right">3270</td>
<td align="left">FALSE</td>
<td align="left">Male</td>
</tr>
<tr class="odd">
<td align="left">My Dinner with Andre</td>
<td align="right">5070</td>
<td align="left">FALSE</td>
<td align="left">Male</td>
</tr>
<tr class="even">
<td align="left">My Dinner with Andre</td>
<td align="right">5070</td>
<td align="left">FALSE</td>
<td align="left">Male</td>
</tr>
<tr class="odd">
<td align="left">Kid Cannabis</td>
<td align="right">5570</td>
<td align="left">FALSE</td>
<td align="left">Male</td>
</tr>
</tbody>
</table>
<p>The scale of box office revenue is completely different! Hence, in Figure <a href="6-regression.html#fig:logtransform1">6.21</a>), it’s really hard to see what’s going on at the lower-end.</p>
<p>Let’s unskew this variable and compare not <em>absolute</em> differences, but rather, <em>relative</em> differences i.e. differences in “order of magnitude” using a <code>log10()</code> transformation:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(biopics, <span class="kw">aes</span>(<span class="dt">x=</span><span class="kw">log10</span>(box_office))) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_histogram</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;log10(Box office revenue)&quot;</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:logtransform2"></span>
<img src="ismaykim_files/figure-html/logtransform2-1.png" alt="Histogram of log10(box office revenue)" width="\textwidth" />
<p class="caption">
Figure 6.22: Histogram of log10(box office revenue)
</p>
</div>
<p>We can see a little better what’s going on at the lower end of the box office revenue scale. However the values on the axes require a little thinking to process. For example at <span class="math inline">\(x=7\)</span>, this corresponds to movies with revenue of <span class="math inline">\(10^7 = 10,000,000\)</span> dollars. So instead, let’s <em>rescale</em> the x-axis so that it displays the data in their original units.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(biopics, <span class="kw">aes</span>(<span class="dt">x=</span>box_office)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_histogram</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_log10</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;Box office revenue (log10-scale))&quot;</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:logtransform3"></span>
<img src="ismaykim_files/figure-html/logtransform3-1.png" alt="Histogram of box office revenue (log-10 scale)" width="\textwidth" />
<p class="caption">
Figure 6.23: Histogram of box office revenue (log-10 scale)
</p>
</div>
<p>Note that</p>
<ul>
<li>The two plots are identical, but the values on the x-axis are different.</li>
<li>In both Figure <a href="6-regression.html#fig:logtransform2">6.22</a>) Figure <a href="6-regression.html#fig:logtransform3">6.23</a>), equivalent distances on each axes correspond to not equivalent absolute differences, but equivalent relative/multiplicative differences. So for example, the horizontal distance on the plot from Budget = <code>1e+05</code> = <span class="math inline">\(10^5\)</span> to Budget = <code>1e+06</code> = <span class="math inline">\(10^6\)</span> is equal to the horizontal distance on the plot from Budget = <code>1e+06</code> = <span class="math inline">\(10^6\)</span> to Budget = <code>1e+07</code> = <span class="math inline">\(10^7\)</span>.</li>
</ul>
</div>
<div id="exploratory-data-analysis-4" class="section level3">
<h3><span class="header-section-number">6.6.2</span> Exploratory data analysis</h3>
<p>Let’s now consider the box office gross earnings in the US of these movies on a log10 scale:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(biopics, <span class="kw">aes</span>(<span class="dt">x=</span>subject_sex, <span class="dt">y=</span>box_office)) <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>person_of_color, <span class="dt">nrow =</span> <span class="dv">1</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_log10</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;Subject sex&quot;</span>, <span class="dt">y=</span><span class="st">&quot;Box office revenue (log10-scale)&quot;</span>, <span class="dt">title=</span><span class="st">&quot;Person of color?&quot;</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:2catxplot"></span>
<img src="ismaykim_files/figure-html/2catxplot-1.png" alt="Box office revenue vs biopic subject info" width="\textwidth" />
<p class="caption">
Figure 6.24: Box office revenue vs biopic subject info
</p>
</div>
<p>It seems in this dataset, men of color had the highest median box office gross. Let’s look at a table of means instead of medians.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">biopics <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(person_of_color, subject_sex) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mean_box_office =</span> <span class="kw">mean</span>(box_office)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(mean_box_office))</code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-183">Table 6.15: </span>Group means</caption>
<thead>
<tr class="header">
<th align="left">person_of_color</th>
<th align="left">subject_sex</th>
<th align="right">mean_box_office</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">TRUE</td>
<td align="left">Male</td>
<td align="right">31648028</td>
</tr>
<tr class="even">
<td align="left">FALSE</td>
<td align="left">Male</td>
<td align="right">22871074</td>
</tr>
<tr class="odd">
<td align="left">TRUE</td>
<td align="left">Female</td>
<td align="right">20035820</td>
</tr>
<tr class="even">
<td align="left">FALSE</td>
<td align="left">Female</td>
<td align="right">18088799</td>
</tr>
</tbody>
</table>
<p>Keep in mind two things though. First, the sample sizes are different:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">biopics <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(person_of_color, subject_sex) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">n =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(n))</code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-185">Table 6.16: </span>Number of movies of each type in dataset</caption>
<thead>
<tr class="header">
<th align="left">person_of_color</th>
<th align="left">subject_sex</th>
<th align="right">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">FALSE</td>
<td align="left">Male</td>
<td align="right">268</td>
</tr>
<tr class="even">
<td align="left">FALSE</td>
<td align="left">Female</td>
<td align="right">93</td>
</tr>
<tr class="odd">
<td align="left">TRUE</td>
<td align="left">Male</td>
<td align="right">61</td>
</tr>
<tr class="even">
<td align="left">TRUE</td>
<td align="left">Female</td>
<td align="right">15</td>
</tr>
</tbody>
</table>
<p>Second, can we <em>generalize</em> these results to <em>all movies</em>? How was the selection of movies sampled? Is it a representative sample of all movies, or was their a systematic reason these were included?</p>
</div>
<div id="multiple-regression-2" class="section level3">
<h3><span class="header-section-number">6.6.3</span> Multiple regression</h3>
<p>Let’s now compute the <em>regression table</em>. Let’s jump straight into considering a model that incorporates an interaction term as described earlier.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">lm</span>(box_office <span class="op">~</span><span class="st"> </span>person_of_color <span class="op">*</span><span class="st"> </span>subject_sex, <span class="dt">data=</span>biopics) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">tidy</span>()</code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-187">Table 6.17: </span>Regression table</caption>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">18088799</td>
<td align="right">3964762</td>
<td align="right">4.5624</td>
<td align="right">0.0000</td>
</tr>
<tr class="even">
<td align="left">person_of_colorTRUE</td>
<td align="right">1947021</td>
<td align="right">10638573</td>
<td align="right">0.1830</td>
<td align="right">0.8549</td>
</tr>
<tr class="odd">
<td align="left">subject_sexMale</td>
<td align="right">4782275</td>
<td align="right">4601541</td>
<td align="right">1.0393</td>
<td align="right">0.2993</td>
</tr>
<tr class="even">
<td align="left">person_of_colorTRUE:subject_sexMale</td>
<td align="right">6829933</td>
<td align="right">11941509</td>
<td align="right">0.5719</td>
<td align="right">0.5677</td>
</tr>
</tbody>
</table>
<p>The model formula is</p>
<p><span class="math display">\[
\begin{align}
\widehat{y} &amp;= b_0 + b_1 x_1 + b_2 x_2 + b_3 x_1x_2\\
\widehat{score} &amp;= b_0 + b_{color}\mathbb{1}[\mbox{of color}] + b_{male} \mathbb{1}[\mbox{is male}] + b_{color,male}\mathbb{1}[\mbox{of color}]\mathbb{1}[\mbox{is male}] \\
\end{align}
\]</span></p>
<p>Recreate four group means from the Table 6.15 above:</p>
<ul>
<li>Female not of color: 18088799 = 18088799 = <span class="math inline">\(b_0\)</span>. Note: <em>Women not of color are the baseline group</em>.</li>
<li>Male not of color: 22871074 = 18088799 + 4782275 = <span class="math inline">\(b_0 + b_{male}\)</span></li>
<li>Female of color: 20035820 = 18088799 + 1947021 = <span class="math inline">\(b_0 + b_{color}\)</span></li>
<li>Male of color: 31648028 = 18088799 + 1947021 + 4782275 + 6829933 = <span class="math inline">\(b_0 + b_{color} + b_{male} + b_{color,male}\)</span>. Note: <span class="math inline">\(b_{color,male}\)</span> is the <em>interaction term</em>.</li>
</ul>

</div>
</div>
</div>



            </section>

          </div>
        </div>
      </div>
<a href="5-wrangling.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="7-sampling.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/ismayc/moderndiver-book/edit/master/06-regression.Rmd",
"text": "Edit"
},
"download": null,
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
